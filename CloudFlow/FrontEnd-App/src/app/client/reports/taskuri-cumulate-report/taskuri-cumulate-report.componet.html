<app-loading *ngIf="loading"></app-loading>
<p-panel [toggleable]="true">
    <p-header>
        {{'LABELS.REPORT_TASKURI_CUMULATE' | translate}}
    </p-header>
    <form [formGroup]="formGroup">
        <div class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid">
            <div class="ui-grid-row">
                <div class="ui-grid-col-3">
                    {{'LABELS.REPORT_TASKURI_CUMULATE_FILTER_ZONA_TASK' | translate}}:
                </div>
                <div class="ui-grid-col-9">
                    <p-dropdown 
                        [options]="zonaTaskSelectItems"
                        [placeholder]="'LABELS.ALL' | translate"
                        [style]="{'width':'100%'}"
                        [showClear]="true"
                        appendTo="body"
                        filter="true"
                        formControlName="zonaTask">
                    </p-dropdown>
                </div>
            </div>

            <div class="ui-grid-row">
                <div class="ui-grid-col-3">
					{{'LABELS.REPORT_TASKURI_CUMULATE_FILTER_DE_LA_DATA' | translate}}*:
                </div>
                <div class="ui-grid-col-9">
					<p-calendar formControlName="deLaData"
							showIcon="true" 
							[dateFormat]="dateFormat"
							monthNavigator="true" 
							yearNavigator="true"
							[yearRange]="yearRange"
							showButtonBar="true"
							appendTo="body" 
                            [dataType]="'date'">
					</p-calendar>
				</div>
            </div>
            <div class="ui-grid-row">
				<div class="ui-grid-col-3"></div>
				<div class="ui-grid-col-9">
					<div *ngIf="deLaDataFormControl.invalid && (deLaDataFormControl.dirty || deLaDataFormControl.touched)" class="ui-message ui-widget ui-corner-all ui-message-error">
						<span class="ui-message-icon pi pi-times"></span>
						<span *ngIf="deLaDataFormControl.errors['required']" class="ui-message-text">{{'MESSAGES.VALIDATOR_MANDATORY_FIELD' | translate}}</span>
					</div>
				</div>
            </div>  

            <div class="ui-grid-row">
                <div class="ui-grid-col-3">
					{{'LABELS.REPORT_TASKURI_CUMULATE_FILTER_PANA_LA_DATA' | translate}}*:
                </div>
                <div class="ui-grid-col-9">
					<p-calendar formControlName="panaLaData"
							showIcon="true" 
							[dateFormat]="dateFormat"
							monthNavigator="true" 
							yearNavigator="true"
							[yearRange]="yearRange"
							showButtonBar="true"
							appendTo="body" 
                            [dataType]="'date'">
					</p-calendar>
				</div>
            </div>
            <div class="ui-grid-row">
				<div class="ui-grid-col-3"></div>
				<div class="ui-grid-col-9">
					<div *ngIf="panaLaDataFormControl.invalid && (panaLaDataFormControl.dirty || panaLaDataFormControl.touched)" class="ui-message ui-widget ui-corner-all ui-message-error">
						<span class="ui-message-icon pi pi-times"></span>
						<span *ngIf="panaLaDataFormControl.errors['required']" class="ui-message-text">{{'MESSAGES.VALIDATOR_MANDATORY_FIELD' | translate}}</span>
					</div>
				</div>
            </div>  

            <div class="ui-grid-row">
                <div class="ui-grid-col-3">
                    {{'LABELS.REPORT_TASKURI_CUMULATE_FILTER_USER_ASIGNAT' | translate}}:
                </div>
                <div class="ui-grid-col-9">
                    <p-dropdown 
                        [options]="userAsignatSelectItems"
                        [placeholder]="'LABELS.ALL' | translate"
                        [style]="{'width':'100%'}"
                        [showClear]="true"
                        appendTo="body"
                        filter="true"
                        formControlName="userAsignat">
                    </p-dropdown>
                </div>
            </div>

            <div class="ui-grid-row">
                <div class="ui-grid-col-3">
                    {{'LABELS.REPORT_TASKURI_CUMULATE_FILTER_STATUS' | translate}}:
                </div>
                <div class="ui-grid-col-9">
                    <p-dropdown 
                        [options]="statusSelectItems"
                        [placeholder]="'LABELS.ALL' | translate"
                        [style]="{'width':'100%'}"
                        [showClear]="true"
                        appendTo="body"
                        formControlName="status">
                    </p-dropdown>
                </div>
            </div>
        </div>
    </form>
    <p-footer>
        <p-button [label]="'LABELS.REPORT_VIEW' | translate" (onClick)="onView()"></p-button>
        <p-button [label]="'LABELS.EXPORT_CSV' | translate" (onClick)="exportCSV()"></p-button>
	</p-footer>
</p-panel>

<p-table *ngIf="reportVisible"
	[value]="report.rows"
    [columns]="columns"
	[responsive]="true"
	[resizableColumns]="true"
	[loading]="loading"
    [style]="{'margin-top':'5px'}"
    [scrollable]="true" 
    [scrollHeight]="scrollHeight">

    <ng-template pTemplate="colgroup">
        <colgroup>
            <col style="width: 25%">
            <col style="width: 35%">
            <col style="width: 25%">
            <col style="width: 15%">
        </colgroup>
    </ng-template>

    <ng-template pTemplate="header">
        <tr>
            <th pResizableColumn>{{ 'LABELS.REPORT_TASKURI_CUMULATE_ZONA_TASK' | translate  }}</th>
            <th pResizableColumn>{{ 'LABELS.REPORT_TASKURI_CUMULATE_DENUMIRE_TASK' | translate  }}</th>
            <th pResizableColumn>{{ 'LABELS.REPORT_TASKURI_CUMULATE_USER_ASIGNAT' | translate  }}</th>
            <th pResizableColumn>{{ 'LABELS.REPORT_TASKURI_CUMULATE_STATUS' | translate  }}</th>
        </tr>
    </ng-template>
    
    <ng-template pTemplate="body" let-row let-rowIndex="rowIndex">
        <tr>
            <td> {{"LABELS.REPORT_TASKURI_CUMULATE_ZONA_" + row.zonaTask | translate}} </td>	
            <td> {{row.denumireTask}} </td>	
            <td> {{row.userAsignat}} </td>	
            <td> {{"LABELS.TASK_" + row.status | translate}} </td>	
        </tr>

    </ng-template>

    <ng-template pTemplate="emptymessage" let-columns>
        <tr>
            <td [attr.colspan]="4">
                {{ "LABELS.NO_RECORDS_FOUND" | translate }}
            </td>
        </tr>
    </ng-template>

</p-table>