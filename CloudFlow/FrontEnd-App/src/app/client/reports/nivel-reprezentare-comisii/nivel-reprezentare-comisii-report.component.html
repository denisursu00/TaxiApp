<app-loading *ngIf="loading"></app-loading>
<p-panel [toggleable]="true">
    <p-header>
        {{ 'LABELS.REPORT_NIVEL_REPREZENTARE_COMISII' | translate }}
    </p-header>

    <form [formGroup]="formGroup">
        <div class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid">

            <div class="ui-grid-row">
                <div class="ui-grid-col-3">
                    {{ 'LABELS.REPORT_NIVEL_REPREZENTARE_COMISII_INSTITUTIE' | translate }}:
                </div>
                <div class="ui-grid-col-9">
                    <app-nomenclator-value-field formControlName="institutie">
                    </app-nomenclator-value-field>
                </div>
            </div>

            <div class="ui-grid-row">
                <div class="ui-grid-col-3">
                    {{ 'LABELS.REPORT_NIVEL_REPREZENTARE_COMISII_DATA_EXPIRARE_MANDAT_DE_LA' | translate }}:
                </div>
                <div class="ui-grid-col-9">
                    <p-calendar formControlName="dataExpirareMandatDeLa" showIcon="true" [readonlyInput]="true"
                        [dateFormat]="dateFormat" monthNavigator="true" yearNavigator="true" [yearRange]="yearRange"
                        showButtonBar="true" appendTo="body" [dataType]="'date'">
                    </p-calendar>
                </div>
            </div>

            <div class="ui-grid-row">
                <div class="ui-grid-col-3">
                    {{ 'LABELS.REPORT_NIVEL_REPREZENTARE_COMISII_DATA_EXPIRARE_MANDAT_PANA_LA' | translate }}:
                </div>
                <div class="ui-grid-col-9">
                    <p-calendar formControlName="dataExpirareMandatPanaLa" showIcon="true" [readonlyInput]="true"
                        [dateFormat]="dateFormat" monthNavigator="true" yearNavigator="true" [yearRange]="yearRange"
                        showButtonBar="true" appendTo="body" [dataType]="'date'">
                    </p-calendar>
                </div>
            </div>
        </div>
    </form>
    <p-footer>
        <p-button [label]="'LABELS.REPORT_VIEW' | translate" (onClick)="onView()"></p-button>
        <p-button [label]="'LABELS.EXPORT_CSV' | translate" (onClick)="exportCSV()"></p-button>
	</p-footer>
</p-panel>

<p-table [value]="report.rows" 
    [responsive]="true" 
    [columns]="columns"
    [resizableColumns]="true" 
    [loading]="loading"
    [style]="{'margin-top':'5px'}"
    [scrollable]="true" 
    [scrollHeight]="scrollHeight">

    <ng-template pTemplate="colgroup">
        <colgroup>
            <col style="width: 50px">
            <col style="width: 40%">
            <col style="width: 10%">
            <col style="width: 10%">
            <col style="width: 10%">
            <col style="width: 10%">
            <col style="width: 10%">
            <col style="width: 10%">
        </colgroup>
    </ng-template>

    <ng-template pTemplate="header">
        <tr>
            <th >{{ 'LABELS.NO_CRT' | translate }}</th>
            <th pResizableColumn > {{ 'LABELS.REPORT_NIVEL_REPREZENTARE_COMISII_INSTITUTIE' | translate  }}</th>
            <th pResizableColumn > {{ 'LABELS.REPORT_NIVEL_REPREZENTARE_COMISII_PRESEDINTI_COMISIE' | translate  }}</th>
            <th pResizableColumn > {{ 'LABELS.REPORT_NIVEL_REPREZENTARE_COMISII_VICEPRESEDINTI_COMISIE' | translate  }}</th>
            <th pResizableColumn > {{ 'LABELS.REPORT_NIVEL_REPREZENTARE_COMISII_REPREZENTARE_ORGANISME_INTERNE' | translate  }}</th>
            <th pResizableColumn > {{ 'LABELS.REPORT_NIVEL_REPREZENTARE_COMISII_REPREZENTARE_ORGANISME_INTERNATIONALE' | translate  }}</th>
            <th pResizableColumn > {{ 'LABELS.REPORT_NIVEL_REPREZENTARE_COMISII_TOTAL_REPREZENTARE' | translate  }}</th>
            <th pResizableColumn > {{ 'LABELS.REPORT_NIVEL_REPREZENTARE_COMISII_PROCENT_REPREZENTARE' | translate  }}</th>
        </tr>
    </ng-template>

    <ng-template pTemplate="body" let-row let-rowIndex="rowIndex">
        <tr>
            <td> {{ rowIndex + 1 }} </td>
            <td> {{ row.institutia }} </td>
            <td> {{ row.nrPresedintiComisie }} </td>
            <td> {{ row.nrVicepresedintiComisie }} </td>
            <td> {{ row.nrReprezOrganismeInterne }} </td>
            <td> {{ row.nrReprezOrganismeInternationale }} </td>
            <td> {{ row.totalReprezentare }} </td>
            <td> {{ row.procentReprezentare.toFixed(2) }} </td>
        </tr>
    </ng-template>

    <ng-template pTemplate="footer">
        <tr>
            <td colspan="2">{{ 'LABELS.REPORT_NIVEL_REPREZENTARE_COMISII_TOTAL' | translate  }}</td>
            <td> {{ report.totalPresedintiComisii }} </td>
            <td> {{ report.totalVicepresedintiComisii }} </td>
            <td> {{ report.totalReprezentareOrganismeInterne }} </td>
            <td> {{ report.totalReprezentareOrganismeInternationale}} </td>
            <td> {{ report.sumaTotalReprezentare }} </td>
            <td> {{ report.totalProcentReprezentare.toFixed(2) }} </td>
        </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage" let-columns>
        <tr>
            <td [attr.colspan]="7">
                {{ "LABELS.NO_RECORDS_FOUND" | translate }}
            </td>
        </tr>
    </ng-template>
</p-table>