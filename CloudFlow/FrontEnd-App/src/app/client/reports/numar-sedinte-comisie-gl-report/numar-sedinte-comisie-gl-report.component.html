<app-loading *ngIf="loading"></app-loading>
<p-panel [toggleable]="true">
    <p-header>
         {{'LABELS.RAPORT_SEDINTE_COMISIE_GL' | translate}}
    </p-header>
    <form [formGroup]="formGroup">		
		<div class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid">
            <div class="ui-grid-row">
                <div class="ui-grid-col-3">
                    {{'LABELS.RAPORT_SEDINTE_COMISIE_GL_FILTER_DE_LA_DATA' | translate}}*:
                </div>
                <div class="ui-grid-col-9">
                    <p-calendar formControlName="dataSedintaDeLa"
                            showIcon="true" 
                            [dateFormat]="dateFormat"
                            monthNavigator="true" 
                            yearNavigator="true"
                            [yearRange]="yearRange"
                            showButtonBar="true"
                            appendTo="body" 
                            [dataType]="'date'">
                    </p-calendar>
                </div>
            </div>
            <div class="ui-grid-row">
				<div class="ui-grid-col-3"></div>
				<div class="ui-grid-col-9">
					<div *ngIf="dataSedintaDeLaFormControl.invalid && (dataSedintaDeLaFormControl.dirty || dataSedintaDeLaFormControl.touched)" class="ui-message ui-widget ui-corner-all ui-message-error">
						<span class="ui-message-icon pi pi-times"></span>
						<span *ngIf="dataSedintaDeLaFormControl.errors['required']" class="ui-message-text">{{'MESSAGES.VALIDATOR_MANDATORY_FIELD' | translate}}</span>
					</div>
				</div>
            </div>    

            <div class="ui-grid-row">
                <div class="ui-grid-col-3">
                    {{'LABELS.RAPORT_SEDINTE_COMISIE_GL_FILTER_PANA_LA_DATA' | translate}}*:
                </div>
                <div class="ui-grid-col-9">
                    <p-calendar formControlName="dataSedintaPanaLa"
                            showIcon="true"  
                            [dateFormat]="dateFormat"
                            monthNavigator="true" 
                            yearNavigator="true"
                            [yearRange]="yearRange"
                            showButtonBar="true"
                            appendTo="body" 
                            [dataType]="'date'">
                    </p-calendar>
                </div>
            </div>
            <div class="ui-grid-row">
                <div class="ui-grid-col-3"></div>
                <div class="ui-grid-col-9">
                    <div *ngIf="dataSedintaPanaLaFormControl.invalid && (dataSedintaPanaLaFormControl.dirty || dataSedintaPanaLaFormControl.touched)" class="ui-message ui-widget ui-corner-all ui-message-error">
                        <span class="ui-message-icon pi pi-times"></span>
                        <span *ngIf="dataSedintaPanaLaFormControl.errors['required']" class="ui-message-text">{{'MESSAGES.VALIDATOR_MANDATORY_FIELD' | translate}}</span>
                    </div>
                </div>
            </div>    
            
            <div class="ui-grid-row">
				<div class="ui-grid-col-3">
					{{'LABELS.RAPORT_SEDINTE_COMISIE_GL_NUME_COMISIE_GL' | translate}}:
				</div>
				<div class="ui-grid-col-9">
					<p-dropdown 
						[options]="comisieSelectItems" 
						[placeholder]="'LABELS.ALL' | translate"
						showClear="true"
                        [style]="{'width':'100%'}" 
                        filter="true"
						formControlName="comisie">
					</p-dropdown>
				</div>
			</div>

            <div class="ui-grid-row">	
				<div class="ui-grid-col-3">
					{{'LABELS.RAPORT_SEDINTE_COMISIE_GL_FILTER_DOCUMENT' | translate}}:
				</div>
				<div class="ui-grid-col-9">
					<app-document-selection-field 
					[selectionMode]="mode"
					[readonly]="false"
					[documentTypeId]="documentTypeId"
					formControlName="document">
					</app-document-selection-field>
				</div>
			</div>     
		</div>
	</form>
	<p-footer>
		<p-button [label]="'LABELS.REPORT_VIEW' | translate" (onClick)="onView()"></p-button>
		<p-button [label]="'LABELS.EXPORT_CSV' | translate" (onClick)="exportCSV()"></p-button>
	</p-footer>
</p-panel>

<p-table *ngIf="reportVisible"
        [value]="report.rows"
		[columns]="columns"
		[selectionMode]="'multiple'"
		[responsive]="true"
		[resizableColumns]="true"
		[loading]="loading"
        [style]="{'margin-top':'5px'}"
        [scrollable]="true" 
        [scrollHeight]="scrollHeight">
    <ng-template pTemplate="colgroup">
        <colgroup>
            <col style="width: 70%">
            <col style="width: 30%">
        </colgroup>
    </ng-template>
	<ng-template pTemplate="header">
			<tr>
				<th pResizableColumn>{{"LABELS.RAPORT_SEDINTE_COMISIE_GL_NUME_COMISIE_GL" | translate}}</th>
				<th pResizableColumn>{{"LABELS.RAPORT_SEDINTE_COMISIE_GL_DATA_SEDINTA" | translate}}</th>
		    </tr>
	</ng-template>
	<ng-template pTemplate="body" let-row let-index="rowIndex">
			<tr [pSelectableRow]="row" >					
				<td>{{row.numeComisieGl}}</td>				
				<td>{{row.dataSedinta | appDateFormater}}</td>			
			</tr>
	</ng-template>
	<ng-template pTemplate="footer" *ngIf="footerVisible">
		<tr>
			<td > <b> {{"LABELS.RAPORT_SEDINTE_COMISIE_GL_TOTAL_COMISIE" | translate}} </b> </td>  
			<td> <b> {{report.totalComisie}} </b> </td>  
	   </tr>
       <tr>
            <td > <b> {{"LABELS.RAPORT_SEDINTE_COMISIE_GL_TOTAL_GL" | translate}} </b> </td>  
            <td> <b> {{report.totalGl}} </b> </td>  
        </tr>
       <tr>
            <td > <b> {{"LABELS.RAPORT_SEDINTE_COMISIE_GL_TOTAL_GENERAL" | translate}} </b> </td>  
            <td> <b> {{report.totalGeneral}} </b> </td>  
        </tr>
    </ng-template>
	<ng-template pTemplate="emptymessage" let-columns>
        <tr>
            <td [attr.colspan]="2">
                {{"LABELS.NO_RECORDS_FOUND" | translate}}
            </td>
        </tr>
    </ng-template>
</p-table>