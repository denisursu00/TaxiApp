<app-loading *ngIf="loading"></app-loading>
<p-panel [toggleable]="true">
    <p-header>
        {{ 'LABELS.REPORT_RASPUNSURI_BANCI' | translate }}
    </p-header>

    <form [formGroup]="formGroup">
        <div class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid">
            <div class="ui-grid-row">
                <div class="ui-grid-col-3">
                    {{ 'LABELS.REPORT_RASPUNSURI_BANCI_BANCA' | translate }}:
                </div>
                <div class="ui-grid-col-9">
                    <p-dropdown [options]="bancaSelectItems" [placeholder]="'LABELS.ALL' | translate" showClear="true"
                        [style]="{'width':'100%'}"
                        filter="true" formControlName="banca">
                    </p-dropdown>
                </div>
            </div>
            <div class="ui-grid-row">
                <div class="ui-grid-col-3">
                    {{ 'LABELS.REPORT_RASPUNSURI_BANCI_PROIECT' | translate }}:
                </div>
                <div class="ui-grid-col-9">
                    <p-dropdown [options]="proiectSelectItems" [placeholder]="'LABELS.ALL' | translate" showClear="true"
                        [style]="{'width':'100%'}" 
                        filter="true" formControlName="proiect">
                    </p-dropdown>
                </div>
            </div>

            <div class="ui-grid-row">
                <div class="ui-grid-col-3">
                    {{ 'LABELS.REPORT_RASPUNSURI_BANCI_TERMEN_RASPUNS_DE_LA' | translate }}:
                </div>
                <div class="ui-grid-col-9">
                    <p-calendar formControlName="termenRaspunsDeLa" showIcon="true" [dateFormat]="dateFormat"
                        monthNavigator="true" yearNavigator="true" [yearRange]="yearRange" showButtonBar="true"
                        appendTo="body" [dataType]="'date'">
                    </p-calendar>
                </div>
            </div>

            <div class="ui-grid-row">
                <div class="ui-grid-col-3">
                    {{ 'LABELS.REPORT_RASPUNSURI_BANCI_TERMEN_RASPUNS_PANA_LA' | translate }}:
                </div>
                <div class="ui-grid-col-9">
                    <p-calendar formControlName="termenRaspunsPanaLa" showIcon="true" [dateFormat]="dateFormat"
                        monthNavigator="true" yearNavigator="true" [yearRange]="yearRange" showButtonBar="true"
                        appendTo="body" [dataType]="'date'">
                    </p-calendar>
                </div>
            </div>
        </div>
    </form>

    <p-footer>
        <p-button [label]="'LABELS.REPORT_VIEW' | translate" (onClick)="onView()"></p-button>
        <p-button [label]="'LABELS.EXPORT_CSV' | translate" (onClick)="exportCSV()"></p-button>
	</p-footer>
</p-panel>

<p-table *ngIf="reportVisible" 
    [value]="report" 
    [columns]="columns"
    [responsive]="true" 
    [resizableColumns]="true" 
    [loading]="loading"
    [style]="{'margin-top':'5px'}"
    [scrollable]="true" 
    [scrollHeight]="scrollHeight">

    <ng-template pTemplate="colgroup">
        <colgroup>
            <col style="width: 250px">
            <col style="width: 250px">
            <col style="width: 250px">
            <col style="width: 250px">
            <col style="width: 250px">
            <col style="width: 250px">
            <col style="width: 250px">
            <col style="width: 250px">
            <col style="width: 250px">
            <col style="width: 250px">
            <col style="width: 250px">
        </colgroup>
    </ng-template>

    <ng-template pTemplate="header">
        <tr>
            <th pResizableColumn style="width: 20%" rowspan="2">{{ 'LABELS.REPORT_RASPUNSURI_BANCI_BANCA' | translate
                }}</th>
            <th pResizableColumn style="width: 80%" colspan="11">{{
                'LABELS.REPORT_RASPUNSURI_BANCI_RASPUNSURI_LA_INTEROGARI_ARB' | translate }}</th>
        </tr>
        <tr>
            <th pResizableColumn>{{ 'LABELS.REPORT_RASPUNSURI_BANCI_RASPUNSURI_FARA_PROPUNERI' | translate }}</th>
            <th pResizableColumn>{{ 'LABELS.REPORT_RASPUNSURI_BANCI_RASPUNSURI_CU_PROPUNERI' | translate }}</th>
            <th pResizableColumn>{{ 'LABELS.REPORT_RASPUNSURI_BANCI_TOTAL_RASPUNSURI' | translate }}</th>
            <th pResizableColumn>{{ 'LABELS.REPORT_RASPUNSURI_BANCI_COEF_STRUCT_CALITATE_RASPUNSURILOR' | translate }}</th>
            <th pResizableColumn>{{ 'LABELS.REPORT_RASPUNSURI_BANCI_NOTA_RASP_ADJUST_CU_CALITATE_RASPUNSURILOR' | translate }}</th>
            <th pResizableColumn>{{ 'LABELS.REPORT_RASPUNSURI_BANCI_NR_RASP_FARA_INTARZIERE' | translate }}</th>
            <th pResizableColumn>{{ 'LABELS.REPORT_RASPUNSURI_BANCI_NR_RASP_CU_INTARZIERE_PESTE_O_ZI' | translate }}</th>
            <th pResizableColumn>{{ 'LABELS.REPORT_RASPUNSURI_BANCI_TOTAL_RASPUNSURI' | translate }}</th>
            <th pResizableColumn>{{ 'LABELS.REPORT_RASPUNSURI_BANCI_COEF_STRUCT_VITEZA_RASPUNSURI' | translate }}</th>
            <th pResizableColumn>{{ 'LABELS.REPORT_RASPUNSURI_BANCI_NOTA_RASP_AJUSTATA_CU_VITEZA_RASPUSURILOR' | translate }}</th>
            <th pResizableColumn>{{ 'LABELS.REPORT_RASPUNSURI_BANCI_NOTA_TOTALA_RASPUSURI_BANCI' |
                translate }}</th>
        </tr>
    </ng-template>

    <ng-template pTemplate="body" let-row let-rowIndex="rowIndex">
        <tr>
            <td>
                 {{ row.denumireBanca }}
            </td>
            <td>
                {{ row.nrRaspunsuriFaraPropuneri }}
            </td>
            <td>
                {{ row.nrRaspunsuriCuPropuneri }}
            </td>
            <td>
                {{ row.nrTotalRaspunsuriPropuneri }}
            </td>
            <td>
                {{ row.coeficientStructuralCalitateRaspunsuri.toFixed(2) }}
            </td>
            <td>
                {{ row.notaRaspunsuriAjustataCuCalitateaRaspunsurilor.toFixed(2) }}
            </td>
            <td>
                {{ row.nrRaspunsuriFaraIntarziere }}
            </td>
            <td>
                {{ row.nrRaspunsuriCuIntarzierePesteOZi }}
            </td>
            <td>
                {{ row.nrTotalRaspunsuriTermen }}
            </td>
            <td>
                {{ row.coeficientStructuralVitezaRaspunsuri.toFixed(2) }}
            </td>
            <td>
                {{ row.notaRaspunsuriAjustataCuVitezaRaspunsurilor.toFixed(2) }}
            </td>
            <td>
                {{ row.notaTotalaRaspunsuriBanci.toFixed(2) }}
            </td>

        </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage" let-columns>
        <tr>
            <td [attr.colspan]="12">
                {{ "LABELS.NO_RECORDS_FOUND" | translate }}
            </td>
        </tr>
    </ng-template>

</p-table>