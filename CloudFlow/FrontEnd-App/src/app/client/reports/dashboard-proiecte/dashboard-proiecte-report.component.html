<app-loading *ngIf="loading"></app-loading>
<p-panel [toggleable]="true">
    <p-header>
         {{'LABELS.REPORT_DASHBOARD_PROIECTE' | translate}}
    </p-header>
    <form [formGroup]="formGroup">		
		<div class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid">
			<div class="ui-grid-row">
				<div class="ui-grid-col-3">
					{{'LABELS.REPORT_DASHBOARD_PROIECTE_ARIE_ACTIVITATE_BANCARA' | translate}}:
				</div>
				<div class="ui-grid-col-9">
					<app-nomenclator-value-field
							formControlName="arieActivitateBancara">
					</app-nomenclator-value-field>
				</div>
			</div>
			<div class="ui-grid-row">
				<div class="ui-grid-col-3">
					{{'LABELS.REPORT_DASHBOARD_PROIECTE_IMPORTANTA_ACTUALA' | translate}}:
				</div>
				<div class="ui-grid-col-9">
					<app-nomenclator-value-field
							formControlName="importantaActuala">
					</app-nomenclator-value-field>
				</div>
			</div>		
			<div class="ui-grid-row">
				<div class="ui-grid-col-3">
					{{'LABELS.REPORT_DASHBOARD_PROIECTE_ABREVIERE_PROIECT' | translate}}:
				</div>
				<div class="ui-grid-col-9">
					<p-dropdown 
						[options]="abreviereProiectSelectItems" 
						[placeholder]="'LABELS.ALL' | translate"
						showClear="true"
						[style]="{'width':'100%'}" 
						formControlName="abreviereProiect"
						filter="true"
						(onChange)=onChangeAbreviereProiect($event)>
					</p-dropdown>
				</div>
			</div>				
			<div class="ui-grid-row" >
				<div class="ui-grid-col-3">
					{{'LABELS.REPORT_DASHBOARD_PROIECTE_TERMEN_FINALIZARE_DE_LA' | translate}}:
				</div>
				<div class="ui-grid-col-9">
					<p-calendar formControlName="termenFinalizareDeLa"
							showIcon="true" 
							[dateFormat]="dateFormat"
							monthNavigator="true" 
							yearNavigator="true"
							[yearRange]="yearRange"
							showButtonBar="true"
							appendTo="body" 
							[dataType]="'date'">
					</p-calendar>
				</div>
			</div>
			<div class="ui-grid-row" >
				<div class="ui-grid-col-3">
					{{'LABELS.REPORT_DASHBOARD_PROIECTE_TERMEN_FINALIZARE_PANA_LA' | translate}}:
				</div>
				<div class="ui-grid-col-9">
					<p-calendar formControlName="termenFinalizarePanaLa"
							showIcon="true" 
							[dateFormat]="dateFormat"
							monthNavigator="true" 
							yearNavigator="true"
							[yearRange]="yearRange"
							showButtonBar="true"
							appendTo="body" 
							[dataType]="'date'">
					</p-calendar>
				</div>
			</div>
			<div class="ui-grid-row">
				<div class="ui-grid-col-3">
					{{'LABELS.REPORT_DASHBOARD_PROIECTE_INCADRARE_PROIECT' | translate}}:
				</div>
				<div class="ui-grid-col-9">
					<app-nomenclator-value-field
							formControlName="incadrareProiect">
					</app-nomenclator-value-field>
				</div>
			</div>	
			<div class="ui-grid-row">
				<div class="ui-grid-col-3">
					{{'LABELS.REPORT_DASHBOARD_PROIECTE_GRAD_REALIZARE_PROIECT_INTERVAL' | translate}}:
				</div><div class="ui-grid-col-1">
					{{gradRealizareRangeValues[0] + ' - ' + gradRealizareRangeValues[1]}}
				</div>
				<div class="ui-grid-col-8 ">
						
					<p-slider 
						[(ngModel)]="gradRealizareRangeValues" 
						[style]="{'width':'100%'}"
						[ngModelOptions]="{standalone: true}"
						[range]="true">
					</p-slider>
				</div>
			</div>	
			<div class="ui-grid-row">
				<div class="ui-grid-col-3">
					{{'LABELS.REPORT_DASHBOARD_PROIECTE_EVALUARE_GRAD_REALIZARE' | translate}}:
				</div>
				<div class="ui-grid-col-9">
					<p-dropdown 
						[options]="evaluareGradRealizareSelectItems" 
						[placeholder]="'LABELS.ALL' | translate"
						showClear="true"
						[style]="{'width':'100%'}" 
						filter="true"
						formControlName="evaluareGradRealizare"></p-dropdown>
				</div>
			</div>	
			<div class="ui-grid-row">
				<div class="ui-grid-col-3">
					{{'LABELS.REPORT_DASHBOARD_PROIECTE_ACTIUNE_DE_URMAT' | translate}}:
				</div>
				<div class="ui-grid-col-9">
					<p-dropdown 
						[options]="actiuniDeUrmatSelectItems" 
						[placeholder]="'LABELS.ALL' | translate"
						showClear="true"
						[style]="{'width':'100%'}" 
						filter="true"
						formControlName="actiuniDeUrmat"></p-dropdown>
				</div>
			</div>
			<div class="ui-grid-row" >
				<div class="ui-grid-col-3">
					{{'LABELS.REPORT_DASHBOARD_PROIECTE_DEADLINE_ACTIUNE_DE_URMAT_DE_LA' | translate}}:
				</div>
				<div class="ui-grid-col-9">
					<p-calendar formControlName="deadlineActiuneDeLa"
							showIcon="true" 
							[dateFormat]="dateFormat"
							monthNavigator="true" 
							yearNavigator="true"
							[yearRange]="yearRange"
							showButtonBar="true"
							appendTo="body" 
							[dataType]="'date'">
					</p-calendar>
				</div>
			</div>
			<div class="ui-grid-row" >
				<div class="ui-grid-col-3">
					{{'LABELS.REPORT_DASHBOARD_PROIECTE_DEADLINE_ACTIUNE_DE_URMAT_PANA_LA' | translate}}:
				</div>
				<div class="ui-grid-col-9">
					<p-calendar formControlName="deadlineActiunePanaLa"
							showIcon="true" 
							[dateFormat]="dateFormat"
							monthNavigator="true" 
							yearNavigator="true"
							[yearRange]="yearRange"
							showButtonBar="true"
							appendTo="body" 
							[dataType]="'date'">
					</p-calendar>
				</div>
			</div>
			<div class="ui-grid-row">
				<div class="ui-grid-col-3">
					{{'LABELS.REPORT_DASHBOARD_PROIECTE_RESPONSABIL_PROIECT' | translate}}:
				</div>
				<div class="ui-grid-col-9">
					<p-dropdown 
						[options]="responsabilProiectSelectItems" 
						[placeholder]="'LABELS.ALL' | translate"
						showClear="true"
						[style]="{'width':'100%'}" 
						filter="true"
						formControlName="responsabilProiect"></p-dropdown>
				</div>
			</div>
			<div class="ui-grid-row">
				<div class="ui-grid-col-3">
					{{'LABELS.REPORT_DASHBOARD_PROIECTE_PROIECT_INITIAT_DE_ARB' | translate}}:
				</div>
				<div class="ui-grid-col-9">
					<p-dropdown 
						[options]="booleanFilterTypes" 
						[placeholder]="'LABELS.ALL' | translate"
						showClear="true"
						[style]="{'width':'100%'}" 
						formControlName="proiectInitiatArb"></p-dropdown>
				</div>
			</div>
			<div class="ui-grid-row">
				<div class="ui-grid-col-3">
					{{'LABELS.REPORT_DASHBOARD_PROIECTE_ARIE_DE_CUPRINDERE' | translate}}:
				</div>
				<div class="ui-grid-col-9">
					<p-dropdown 
						[options]="arieCuprindereSelectItems" 
						[placeholder]="'LABELS.ALL' | translate"
						showClear="true"
						[style]="{'width':'100%'}" 
						filter="true"
						formControlName="arieCuprindere"></p-dropdown>
				</div>
			</div>

		</div>
	</form>
	<p-footer>
		<p-button [label]="'LABELS.REPORT_VIEW' | translate" (onClick)="onView()"></p-button>
		<p-button [label]="'LABELS.EXPORT_CSV' | translate" (onClick)="exportCSV()"></p-button>
	</p-footer>
</p-panel>


<p-table 
		[value]="reportRows"  
		[columns]="columns"
		[responsive]="true"
		[resizableColumns]="true"
		[loading]="loading"
		[style]="{'margin-top':'5px'}"
		[scrollable]="true" 
		[scrollHeight]="scrollHeight">

	<ng-template pTemplate="colgroup">
		<colgroup>
			<col style="width: 50px">
			<col style="width: 150px">
			<col style="width: 100px">
			<col style="width: 150px">
			<col style="width: 100px">
			<col style="width: 100px">
			<col style="width: 100px">
			<col style="width: 100px">
			<col style="width: 150px">
			<col style="width: 100px">
			<col style="width: 100px">
			<col style="width: 100px">
			<col style="width: 100px">
			<col style="width: 100px">
			<col style="width: 100px">
			<col style="width: 150px">
			<col style="width: 150px">
			<col style="width: 100px">
			<col style="width: 100px">
			<col style="width: 150px">
			<col style="width: 150px">
			<col style="width: 150px">
			<col style="width: 100px">
			<col style="width: 150px">
			<col style="width: 100px">
			<col style="width: 100px">
			<col style="width: 100px">
		</colgroup>
	</ng-template>

	<ng-template pTemplate="header">
			<tr>
				<th>{{"LABELS.NO_CRT" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_ARIE_ACTIVITATE_BANCARA" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_IMPORTANTA_ACTUALA" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_DENUMIRE_PROIECT" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_ABREVIERE_PROIECT" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_DATA_INITIERII" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_TERMEN_FINALIZARE" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_GRAD_REALIZARE_ESTIMAT" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_INCADRARE_PROIECT" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_GRAD_REALIZARE_PROIECT" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_PERIOADA_SCURSA" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_PERIOADA_RAMASA" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_NR_ZILE_PROIECT" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_PARAMETRU_1" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_PARAMETRU_2" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_EVALUARE_GRAD_REALIZARE" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_ACTIUNE_DE_URMAT" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_DEADLINE_ACTIUNE_DE_URMAT" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_PRIORITATE" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_DESCRIERE" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_RESPONSABIL_PROIECT" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_DELEGAT_RESPONSABIL_ARB" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_STADIU" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_IMPACT" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_PROIECT_INITIAT_DE_ARB" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_ARIE_DE_CUPRINDERE" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_DASHBOARD_PROIECTE_PROIECT_INITIAT_DE_ALTA_ENTITATE" | translate}}</th>
			</tr>
	</ng-template>
	<ng-template pTemplate="body" let-row let-rowIndex="rowIndex">
			<tr >				
				<td>{{rowIndex + 1}}</td>			
				<td *ngIf="rowGroupMetadata[row.denumireProiect].index === rowIndex" [attr.rowspan]="rowGroupMetadata[row.denumireProiect].size" >{{ row.arieActivitateBancara }}</td>
				<td *ngIf="rowGroupMetadata[row.denumireProiect].index === rowIndex" [attr.rowspan]="rowGroupMetadata[row.denumireProiect].size"
					[ngStyle]="row.importantaActualaCuloareStyle"> {{ row.importantaActuala }}	
				</td>
				<td *ngIf="rowGroupMetadata[row.denumireProiect].index === rowIndex" [attr.rowspan]="rowGroupMetadata[row.denumireProiect].size">{{ row.denumireProiect }}</td>
				<td *ngIf="rowGroupMetadata[row.denumireProiect].index === rowIndex" [attr.rowspan]="rowGroupMetadata[row.denumireProiect].size">{{ row.abreviereProiect }}</td>
				<td *ngIf="rowGroupMetadata[row.denumireProiect].index === rowIndex" [attr.rowspan]="rowGroupMetadata[row.denumireProiect].size">{{ row.dataInitieriiForDisplay}}</td>
				<td *ngIf="rowGroupMetadata[row.denumireProiect].index === rowIndex" [attr.rowspan]="rowGroupMetadata[row.denumireProiect].size">{{ row.termendeFinalizareForDisplay }}</td>
				<td *ngIf="rowGroupMetadata[row.denumireProiect].index === rowIndex" [attr.rowspan]="rowGroupMetadata[row.denumireProiect].size">{{ row.gradRealizareEstimat }}</td>
				<td *ngIf="rowGroupMetadata[row.denumireProiect].index === rowIndex" [attr.rowspan]="rowGroupMetadata[row.denumireProiect].size">{{ row.incadrareProiect }}</td>
				<td *ngIf="rowGroupMetadata[row.denumireProiect].index === rowIndex" [attr.rowspan]="rowGroupMetadata[row.denumireProiect].size">{{ row.gradRealizareProiect }}</td>
				<td *ngIf="rowGroupMetadata[row.denumireProiect].index === rowIndex" [attr.rowspan]="rowGroupMetadata[row.denumireProiect].size">{{ row.nrZilePerioadaScursa }}</td>
				<td *ngIf="rowGroupMetadata[row.denumireProiect].index === rowIndex" [attr.rowspan]="rowGroupMetadata[row.denumireProiect].size">{{ row.nrZilePerioadaRamasa }}</td>
				<td *ngIf="rowGroupMetadata[row.denumireProiect].index === rowIndex" [attr.rowspan]="rowGroupMetadata[row.denumireProiect].size">{{ row.nrZileProiect }}</td>
				<td *ngIf="rowGroupMetadata[row.denumireProiect].index === rowIndex" [attr.rowspan]="rowGroupMetadata[row.denumireProiect].size">{{ row.parametru1ForDisplay | translate }}</td>
				<td *ngIf="rowGroupMetadata[row.denumireProiect].index === rowIndex" [attr.rowspan]="rowGroupMetadata[row.denumireProiect].size">{{ row.parametru2ForDisplay | translate }}</td>
				<td *ngIf="rowGroupMetadata[row.denumireProiect].index === rowIndex" [attr.rowspan]="rowGroupMetadata[row.denumireProiect].size">{{ row.evaluareGradRealizareForDisplay | translate}}</td>
				<td> {{ row.actiuneDeUrmat }}</td>
				<td> {{ row.deadlineActiuneDeUrmatForDisplay }}</td>
				<td *ngIf="rowGroupMetadata[row.denumireProiect].index === rowIndex" [attr.rowspan]="rowGroupMetadata[row.denumireProiect].size">{{ row.prioritate }}</td>
				<td>{{ row.descriere }}</td>
				<td *ngIf="rowGroupMetadata[row.denumireProiect].index === rowIndex" [attr.rowspan]="rowGroupMetadata[row.denumireProiect].size">{{ row.responsabilproiect }}</td>
				<td *ngIf="rowGroupMetadata[row.denumireProiect].index === rowIndex" [attr.rowspan]="rowGroupMetadata[row.denumireProiect].size">{{ row.delegatResponsabilArb }}</td>
				<td *ngIf="rowGroupMetadata[row.denumireProiect].index === rowIndex" [attr.rowspan]="rowGroupMetadata[row.denumireProiect].size">{{ row.stadiuForDisplay | translate }}</td>
				<td *ngIf="rowGroupMetadata[row.denumireProiect].index === rowIndex" [attr.rowspan]="rowGroupMetadata[row.denumireProiect].size">{{ row.impact }}</td>
				<td *ngIf="rowGroupMetadata[row.denumireProiect].index === rowIndex" [attr.rowspan]="rowGroupMetadata[row.denumireProiect].size">{{ row.proiectInitiatDeARBDisplay | translate }}</td>
				<td *ngIf="rowGroupMetadata[row.denumireProiect].index === rowIndex" [attr.rowspan]="rowGroupMetadata[row.denumireProiect].size">{{ row.arieDeCuprindereForDisplay | translate }}</td>
				<td *ngIf="rowGroupMetadata[row.denumireProiect].index === rowIndex" [attr.rowspan]="rowGroupMetadata[row.denumireProiect].size">{{ row.proiectInitiatDeAltaEntitate }}</td>
			</tr>
	</ng-template>
	
	<ng-template pTemplate="emptymessage" let-columns>
        <tr>
            <td [attr.colspan]="26">
                {{"LABELS.NO_RECORDS_FOUND" | translate}}
            </td>
        </tr>
    </ng-template>
</p-table>