<app-loading *ngIf="loading"></app-loading>
<p-panel [toggleable]="true">
    <p-header>
         {{'LABELS.REPORT_PREZENTA_AGA' | translate}}
    </p-header>
    <form [formGroup]="formGroup">		
		<div class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid">
			<div class="ui-grid-row">	
				<div class="ui-grid-col-3">
					{{'LABELS.REPORT_PREZENTA_AGA_FILTER_DOCUMENT' | translate}}*:
				</div>
				<div class="ui-grid-col-9">
					<app-document-selection-field 
					[selectionMode]="mode"
					[readonly]="false"
					[documentTypeId]="documentTypeId"
					formControlName="document">
					</app-document-selection-field>
				</div>
			</div>
			<div class="ui-grid-row">
				<div class="ui-grid-col-3"></div>
				<div class="ui-grid-col-9">
					<div *ngIf="documentFormControl.invalid && (documentFormControl.dirty || documentFormControl.touched)" class="ui-message ui-widget ui-corner-all ui-message-error">
						<span class="ui-message-icon pi pi-times"></span>
						<span *ngIf="documentFormControl.errors['required']" class="ui-message-text">{{'MESSAGES.VALIDATOR_MANDATORY_FIELD' | translate}}</span>
					</div>
				</div>
			</div>
            <div class="ui-grid-row">
				<div class="ui-grid-col-3">
					{{'LABELS.REPORT_PREZENTA_AGA_FILTER_BANCA' | translate}}:
				</div>
				<div class="ui-grid-col-9">
					<p-dropdown 
						[options]="bancaSelectItems" 
						[placeholder]="'LABELS.ALL' | translate"
						showClear="true"
						[style]="{'width':'100%'}" 
						filter="true"
						formControlName="banca">
					</p-dropdown>
				</div>
			</div>

            <div class="ui-grid-row">
				<div class="ui-grid-col-3">
					{{'LABELS.REPORT_PREZENTA_AGA_FILTER_FUNCTIE' | translate}}:
				</div>
				<div class="ui-grid-col-9">
                    <input 
                        type="text" 
						[style]="{'width':'100%'}" 
						formControlName="functie"
                        pInputText> 
				</div>
			</div>
			
			<div class="ui-grid-row">
					<div class="ui-grid-col-3">
					{{ 'LABELS.REPORT_PREZENTA_AGA_FILTER_DE_LA_DATA' | translate }}:
				</div>
				<div class="ui-grid-col-9">
					<p-calendar formControlName="deLaDataInceput" showIcon="true" 
						[dateFormat]="dateFormat" monthNavigator="true" yearNavigator="true" [yearRange]="yearRange"
						showButtonBar="true" appendTo="body" [dataType]="'date'">
					</p-calendar>
				</div>
			</div>

			<div class="ui-grid-row">
				<div class="ui-grid-col-3">
					{{ 'LABELS.REPORT_PREZENTA_AGA_FILTER_PANA_LA_DATA' | translate }}:
				</div>
				<div class="ui-grid-col-9">
					<p-calendar formControlName="panaLaDataInceput" showIcon="true" 
						[dateFormat]="dateFormat" monthNavigator="true" yearNavigator="true" [yearRange]="yearRange"
						showButtonBar="true" appendTo="body" [dataType]="'date'">
					</p-calendar>
				</div>
			</div>
		</div>
	</form>
	<p-footer>
		<p-button [label]="'LABELS.REPORT_VIEW' | translate" (onClick)="onView()"></p-button>
		<p-button [label]="'LABELS.EXPORT_CSV' | translate" (onClick)="exportCSV()"></p-button>
	</p-footer>
</p-panel>

<p-table *ngIf="reportVisible"
        [value]="report.rows"
		[columns]="columns"
		[selectionMode]="'multiple'"
		[responsive]="true"
		[resizableColumns]="true"
		[loading]="loading"
		[style]="{'margin-top':'5px'}"
		[scrollable]="true" 
		[scrollHeight]="scrollHeight">
		
	<ng-template pTemplate="colgroup">
		<colgroup>
			<col style="width: 50px">
			<col style="width: 11%">
			<col style="width: 11%">
			<col style="width: 11%">
			<col style="width: 11%">
			<col style="width: 11%">
			<col style="width: 11%">
			<col style="width: 11%">
			<col style="width: 11%">
			<col style="width: 11%">
		</colgroup>
	</ng-template>

	<ng-template pTemplate="header">
			<tr>
				<th>{{"LABELS.NO_CRT" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_PREZENTA_AGA_BANCA" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_PREZENTA_AGA_CONFIRMARE" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_PREZENTA_AGA_FUNCTIE" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_PREZENTA_AGA_NECESITA_IMPUTERNICIRE" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_PREZENTA_AGA_PREZENTA_MEMBRI_NIVEL_PRESEDINTE" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_PREZENTA_AGA_PREZENTA_MEMBRI_NIVEL_VICEPRESEDINTE" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_PREZENTA_AGA_PREZENTA_MEMBRI_NIVEL_IMPUTERNICIT" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_PREZENTA_AGA_TOTAL_PREZENTA" | translate}}</th>
				<th pResizableColumn>{{"LABELS.REPORT_PREZENTA_AGA_MEMBRI_VOTANTI" | translate}}</th>
			</tr>
	</ng-template>
	<ng-template pTemplate="body" let-row let-index="rowIndex">
			<tr [pSelectableRow]="row" 
					[style.background-color]="row.banca != null ? '#cccccc' : 'none'"
					[style.font-weight]="row.banca != null ? 'bold' : 'none'">					
				<td>{{row.nrCrt}}</td>				
				<td>{{row.banca}}</td>				
				<td>{{row.confirmare}}</td>				
				<td>{{row.functie}}</td>				
				<td>{{row.necesitaImputernicire}}</td>				
				<td>{{row.prezentaMembriNivelPresedinte}}</td>		
				<td>{{row.prezentaMembriNivelVicepresedinte}}</td>		
				<td>{{row.prezentaMembriNivelImputernicit}}</td>		
				<td>{{row.totalPrezenta}}</td>		
				<td>{{row.membriVotanti}}</td>			
			</tr>
	</ng-template>
	<ng-template pTemplate="footer" *ngIf="footerVisible">
		<tr>
			<td></td>
			<td > <b> {{"LABELS.REPORT_PREZENTA_AGA_PREZENTA_ACTTUALA" | translate}} </b> </td>  
			<td></td>
			<td></td>
			<td></td>
			<td> <b> {{report.prezentaActualaPresedinte}} </b> </td>  
			<td> <b> {{report.prezentaActualaVicepresedinte}} </b> </td>  
			<td> <b> {{report.prezentaActualaInlocuitor}} </b> </td>  
			<td> <b> {{report.prezentaActualaTotal}} </b> </td>  
			<td> <b> {{report.prezentaActualaMembriVotanti}} </b> </td>  
	   </tr>
	   <tr>
			<td></td>
			<td > <b> {{"LABELS.REPORT_PREZENTA_AGA_PREZENTA_POCENT" | translate}} </b> </td>  
			<td></td>
			<td></td>
			<td></td>
			<td> <b> {{report.prezentaProcentPresedinte | number:'1.0-0'}}% </b> </td>  
			<td> <b> {{report.prezentaProcentVicepresedinte | number:'1.0-0'}}% </b> </td>  
			<td> <b> {{report.prezentaProcentInlocuitor | number:'1.0-0'}}% </b> </td>  
			<td></td>  
			<td> <b> {{report.prezentaProcentMembriVotanti}}% </b> </td>  
	   </tr>
	   <tr>
			<td></td>
			<td > {{"LABELS.REPORT_PREZENTA_AGA_MEMBRI_ASOCIATI" | translate}} </td>  
			<td></td>
			<td></td>
			<td></td>
			<td></td>  
			<td></td>  
			<td></td>  
			<td></td>  
			<td> {{report.membriAsociatie}} </td>  
	   </tr>
	   <tr>
			<td></td>
			<td > <b> {{"LABELS.REPORT_PREZENTA_AGA_PREZENTA_NECESARA" | translate}} </b> </td>  
			<td></td>
			<td></td>
			<td></td>
			<td></td>  
			<td></td>  
			<td></td>  
			<td></td>  
			<td> {{report.prezentaNecesara | number:'1.0-0'}} </td>  
	   </tr>
	   <tr>
			<td></td>
			<td > <b> {{"LABELS.REPORT_PREZENTA_AGA_REST_NECESAR" | translate}} </b> </td>  
			<td></td>
			<td></td>
			<td></td>
			<td></td>  
			<td></td>  
			<td></td>  
			<td></td>  
			<td> {{report.restNecesarPrezenta}} </td>  
	   </tr>
	   <tr>
			<td></td>
			<td > <b> {{"LABELS.REPORT_PREZENTA_AGA_ADOPTARE_HOTARARE" | translate}} </b> </td>  
			<td></td>
			<td></td>
			<td></td>
			<td></td>  
			<td></td>  
			<td></td>  
			<td></td>  
			<td></td>  
	   </tr>
	   <tr>
			<td></td>
			<td > {{"LABELS.REPORT_PREZENTA_AGA_NECESAR_ADOPTARE" | translate}} </td>  
			<td></td>
			<td></td>
			<td></td>
			<td></td>  
			<td></td>  
			<td></td>  
			<td></td>  
			<td> {{report.necesarAdoptare | number:'1.0-0'}} </td>  
	   </tr>
	   <tr>
			<td></td>
			<td > {{"LABELS.REPORT_PREZENTA_AGA_JUMATE_PLUS_UNU" | translate}}  </td>  
			<td></td>
			<td></td>
			<td></td>
			<td></td>  
			<td></td>  
			<td></td>  
			<td></td>  
			<td> {{report.jumatePlusUnu | number:'1.0-0'}} </td>  
	   </tr>
	   <tr>
			<td></td>
			<td > <b> {{"LABELS.REPORT_PREZENTA_AGA_NECESAR_ADOPTARE_HOTARARE" | translate}} </b> </td>  
			<td></td>
			<td></td>
			<td></td>
			<td></td>  
			<td></td>  
			<td></td>  
			<td></td>  
			<td> {{report.necesarAdoptareHotarare | number:'1.0-0'}} </td>  
	   </tr>
	   <tr>
			<td></td>
			<td > {{"LABELS.REPORT_PREZENTA_AGA_NECESAR_VOT_SECRET" | translate}}  </td>  
			<td></td>
			<td></td>
			<td></td>
			<td></td>  
			<td></td>  
			<td></td>  
			<td></td>  
			<td> {{report.necesarPentruVotSecret}} </td>  
	   </tr>
    </ng-template>
	<ng-template pTemplate="emptymessage" let-columns>
        <tr>
            <td [attr.colspan]="10">
                {{"LABELS.NO_RECORDS_FOUND" | translate}}
            </td>
        </tr>
    </ng-template>
</p-table>