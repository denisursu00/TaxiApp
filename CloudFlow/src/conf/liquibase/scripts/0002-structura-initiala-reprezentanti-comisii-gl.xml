<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd
        	http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

	<changeSet id="0002-creare-tabele" author="CloudSoft.User1">
		<sql endDelimiter=";">
			CREATE TABLE REPREZENTANTI_COMISIE_GL (
				ID BIGINT NOT NULL,
				COMISIE_GL_ID BIGINT NOT NULL,
				PRESEDINTE_ID BIGINT NOT NULL,
				DATA_EXP_MANDAT_PRESEDINTE DATE NOT NULL,
				VICEPRESEDINTE1_ID BIGINT NOT NULL,
				DATA_EXP_MANDAT_VICEPRESEDINT1 DATE NOT NULL,
				VICEPRESEDINTE2_ID BIGINT,
				DATA_EXP_MANDAT_VICEPRESEDINT2 DATE,
				VICEPRESEDINTE3_ID BIGINT,
				DATA_EXP_MANDAT_VICEPRESEDINT3 DATE,
				RESPONSABIL_ARB_ID BIGINT,
				MEMBRU_CD_COORDONATOR_ID BIGINT NOT NULL,
				DATA_EXP_MANDAT_MEMBRU_CD_CRDT DATE NOT NULL,
				
				CONSTRAINT PK_REPREZENTANTI_COMISIE_GL PRIMARY KEY (ID)
			);
			
			CREATE TABLE MEMBRI_REPREZENTANT_COMISIE_GL (
				ID BIGINT NOT NULL,
				REPREZENTANTI_COMISIE_GL_ID BIGINT NOT NULL,				
				INSTITUTIE_ID BIGINT NOT NULL,
				MEMBRU_INSTITUTIE_ID BIGINT,				
				NUME TEXT,				
				PRENUME TEXT,				
				FUNCTIE TEXT,				
				DEPARTAMENT TEXT,			
				EMAIL TEXT,			
				TELEFON TEXT,				
				CALITATE TEXT NOT NULL,
				STARE TEXT NOT NULL,
				
				CONSTRAINT PK_MEM_REPREZENTANT_COMISIE_GL PRIMARY KEY (ID)
			);
		</sql>
	</changeSet>
	
	<changeSet id="0002-adaugare-constrangeri" author="CloudSoft.User1">
		<sql endDelimiter=";">			
			ALTER TABLE REPREZENTANTI_COMISIE_GL ADD CONSTRAINT REPREZ_COM_GL_COMISIE_GL_ID_UQ UNIQUE (COMISIE_GL_ID);
			ALTER TABLE REPREZENTANTI_COMISIE_GL ADD CONSTRAINT REPREZ_COM_GL_COMISIE_GL_ID_FK FOREIGN KEY ( COMISIE_GL_ID ) REFERENCES NOMENCLATOR_VALUES ( ID );
			ALTER TABLE REPREZENTANTI_COMISIE_GL ADD CONSTRAINT REPREZ_COM_GL_PRESEDINTE_ID_FK FOREIGN KEY ( PRESEDINTE_ID ) REFERENCES NOMENCLATOR_VALUES ( ID );
			ALTER TABLE REPREZENTANTI_COMISIE_GL ADD CONSTRAINT REPREZ_COM_GL_VICEPRESD1_ID_FK FOREIGN KEY ( VICEPRESEDINTE1_ID ) REFERENCES NOMENCLATOR_VALUES ( ID );
			ALTER TABLE REPREZENTANTI_COMISIE_GL ADD CONSTRAINT REPREZ_COM_GL_VICEPRESD2_ID_FK FOREIGN KEY ( VICEPRESEDINTE2_ID ) REFERENCES NOMENCLATOR_VALUES ( ID );
			ALTER TABLE REPREZENTANTI_COMISIE_GL ADD CONSTRAINT REPREZ_COM_GL_VICEPRESD3_ID_FK FOREIGN KEY ( VICEPRESEDINTE3_ID ) REFERENCES NOMENCLATOR_VALUES ( ID );
			ALTER TABLE REPREZENTANTI_COMISIE_GL ADD CONSTRAINT REPREZ_COM_GL_RESPBL_ARB_ID_FK FOREIGN KEY ( RESPONSABIL_ARB_ID ) REFERENCES EDOCUSER ( ORG_ENTITY_ID );
			ALTER TABLE REPREZENTANTI_COMISIE_GL ADD CONSTRAINT REPREZ_COM_GL_MBR_CD_CRD_ID_FK FOREIGN KEY ( MEMBRU_CD_COORDONATOR_ID ) REFERENCES NOMENCLATOR_VALUES ( ID );			
			
			ALTER TABLE MEMBRI_REPREZENTANT_COMISIE_GL ADD CONSTRAINT MREPREZ_COM_GL_REPREZENT_ID_FK FOREIGN KEY ( REPREZENTANTI_COMISIE_GL_ID ) REFERENCES REPREZENTANTI_COMISIE_GL ( ID );
			ALTER TABLE MEMBRI_REPREZENTANT_COMISIE_GL ADD CONSTRAINT MREPREZ_COM_GL_INSTITTIE_ID_FK FOREIGN KEY ( INSTITUTIE_ID ) REFERENCES NOMENCLATOR_VALUES ( ID );			
		</sql>
	</changeSet>
	
</databaseChangeLog>