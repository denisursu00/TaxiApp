<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
	xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd
        	http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

	<changeSet id="0053-adaugare-tabele-export-documente-JR" author="CloudSoft.User3">
		<sql endDelimiter=";"><![CDATA[
			CREATE TABLE export_document (
				id BIGINT NOT NULL,
				jr_id TEXT NOT NULL,
				type TEXT NOT NULL,
				archived BOOLEAN NULL,
				CONSTRAINT export_document_pk PRIMARY KEY (id),
				CONSTRAINT export_document_uq UNIQUE (jr_id)
			);
			CREATE TABLE export_metadata (
				id BIGINT NOT NULL,
				export_document_id BIGINT NOT NULL,
				name TEXT NOT NULL,
				value TEXT NULL,
				CONSTRAINT export_metadata_pk PRIMARY KEY (id),
				CONSTRAINT export_metadata_uq UNIQUE (export_document_id, name),
				CONSTRAINT export_metadata_export_document_fk FOREIGN KEY (export_document_id) REFERENCES export_document (id)	
			);
			CREATE TABLE export_attachment (
				id BIGINT NOT NULL,
				export_document_id BIGINT NOT NULL,
				name TEXT NOT NULL,
				content bytea NOT NULL,
				type TEXT NOT NULL,
				CONSTRAINT export_attachment_pk PRIMARY KEY (id),
				CONSTRAINT export_attachment_uq UNIQUE (export_document_id, name),
				CONSTRAINT export_attachment_export_document_fk FOREIGN KEY (export_document_id) REFERENCES export_document (id)
			);
		]]>
		</sql>
	</changeSet>
	
</databaseChangeLog>