<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
	xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd
        	http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

	<changeSet id="0044-adaugare-coloana-ui_send_confirmation-in-tabel-workflowtransition" author="CloudSoft.User1">
		<sql endDelimiter=";"><![CDATA[
			ALTER TABLE workflowtransition ADD ui_send_confirmation BOOLEAN default FALSE;
		]]>
		</sql>
	</changeSet>
	
	<changeSet id="0044-setare-ui_send_confirmation-pe-true-pt-anumite-tranzitii-la-fluxuri" author="CloudSoft.User1">
		<sql endDelimiter=";"><![CDATA[
			update workflowtransition 
			set ui_send_confirmation=true
			where workflow_id = (select id from workflow where name='Agenda sedinta PVG') 
				and startstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Agenda sedinta PVG') and code='definitivare_agenda_pvg');
				
			update workflowtransition 
			set ui_send_confirmation=true
			where workflow_id = (select id from workflow where name='Avans Salarial') 
				and startstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Avans Salarial') and code='initiere_completare_metadate');
			
			update workflowtransition 
			set ui_send_confirmation=true
			where workflow_id = (select id from workflow where name='Cerere concediu') 
				and startstate_id in (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Cerere concediu') and code in ('completare_metadate_cfp_concediu_nepersonal', 'completare_metadate_cfp_concediu_personal', 'completare_metadate_cm_concediu_nepersonal', 'completare_metadate_cm_concediu_personal', 'completare_metadate_co_concediu_personal', 'completare_metadate_css_concediu_nepersonal', 'completare_metadate_css_concediu_personal'));
			
			update workflowtransition 
			set ui_send_confirmation=true
			where workflow_id = (select id from workflow where name='Cerere rechemare') 
				and startstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Cerere rechemare') and code='initiere_cerere_rechemare_si_completare_metadate');
			
			update workflowtransition 
			set ui_send_confirmation=true
			where workflow_id = (select id from workflow where name='Conciliere') 
				and startstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Conciliere') and code='completare_finala_metadate');
			
			update workflowtransition 
			set ui_send_confirmation=true
			where workflow_id = (select id from workflow where name='Decizie deplasare') 
				and startstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Decizie deplasare') and code='completare_metadate_decizie_deplasare');
			
			update workflowtransition 
			set ui_send_confirmation=true
			where workflow_id = (select id from workflow where name='Decizie rechemare') 
				and startstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Decizie rechemare') and code='initiere_decizie_rechemare_completare_metadate');
			
			update workflowtransition 
			set ui_send_confirmation=true
			where workflow_id = (select id from workflow where name='Initiere DSP') 
				and startstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Initiere DSP') and code='validare_participanti_desemnati')
				and finalstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Initiere DSP') and code='marcare_proiect_activitati_in_proiecte');
			
			update workflowtransition 
			set ui_send_confirmation=true
			where workflow_id = (select id from workflow where name='Investigatie') 
				and startstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Investigatie') and code='completare_finala_metadate');
			
			update workflowtransition 
			set ui_send_confirmation=true
			where workflow_id = (select id from workflow where name='Minuta sedinta Comisie GL') 
				and startstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Minuta sedinta Comisie GL') and code='verificare_minuta')
				and finalstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Minuta sedinta Comisie GL') and code='adaugare_comentariu_atasament');
			
			update workflowtransition 
			set ui_send_confirmation=true
			where workflow_id = (select id from workflow where name='Misiune de audit si control') 
				and startstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Misiune de audit si control') and code='completare_metadate');
			
			update workflowtransition 
			set ui_send_confirmation=true
			where workflow_id = (select id from workflow where name='Modificare schema') 
				and startstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Modificare schema') and code='completare_metadate_modificare_schema');
			
			update workflowtransition 
			set ui_send_confirmation=true
			where workflow_id = (select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS') 
				and startstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS') and code='verificare_nota_cd')
				and finalstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS') and code='adaugare_atasament');
			
			update workflowtransition 
			set ui_send_confirmation=true
			where workflow_id = (select id from workflow where name='Nota CD - Directori') 
				and startstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Nota CD - Directori') and code='verificare_nota_cd')
				and finalstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Nota CD - Directori') and code='adaugare_atasament');
			
			update workflowtransition 
			set ui_send_confirmation=true
			where workflow_id = (select id from workflow where name='Nota CD - Responsabil') 
				and startstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Nota CD - Responsabil') and code='verificare_nota_cd')
				and finalstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Nota CD - Responsabil') and code='adaugare_atasament');
			
			update workflowtransition 
			set ui_send_confirmation=true
			where workflow_id = (select id from workflow where name='Nota CD - Useri ARB') 
				and startstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Nota CD - Useri ARB') and code='verificare_nota_cd')
				and finalstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Nota CD - Useri ARB') and code='adaugare_atasament');
			
			update workflowtransition 
			set ui_send_confirmation=true
			where workflow_id = (select id from workflow where name='Nota PVG') 
				and startstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Nota PVG') and code='verificare_nota_pvg')
				and finalstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Nota PVG') and code='adaugare_atasament');
			
			update workflowtransition 
			set ui_send_confirmation=true
			where workflow_id = (select id from workflow where name='Ordine de zi CD') 
				and startstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Ordine de zi CD') and code='definitivare_ordine_de_zi');
			
			update workflowtransition 
			set ui_send_confirmation=true
			where workflow_id = (select id from workflow where name='Prezenta AGA') 
				and startstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Prezenta AGA') and code='completare_metadate_prezenta');
			
			update workflowtransition 
			set ui_send_confirmation=true
			where workflow_id = (select id from workflow where name='Prezenta CD PVG') 
				and startstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Prezenta CD PVG') and code='definitivare_prezenta_cd_pvg');
			
			update workflowtransition 
			set ui_send_confirmation=true
			where workflow_id = (select id from workflow where name='Prezenta Comisie GL') 
				and startstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Prezenta Comisie GL') and code='completare_metadate_prezenta');
			
			update workflowtransition 
			set ui_send_confirmation=true
			where workflow_id = (select id from workflow where name='Proces verbal CD') 
				and startstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Proces verbal CD') and code='verificare_proces_verbal_cd')
				and finalstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Proces verbal CD') and code='adaugare_comentariu_atasament');
			
			update workflowtransition 
			set ui_send_confirmation=true
			where workflow_id = (select id from workflow where name='Referat suplimentare buget') 
				and startstate_id = (select id from workflowstate where temp_workflow_id_ = (select id from workflow where name='Referat suplimentare buget') and code='completare_metadate_referat');
		]]>
		</sql>
	</changeSet>
	
</databaseChangeLog>