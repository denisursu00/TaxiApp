<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
	xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd
        	http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

	<changeSet id="0043-update-restrictedoneditstates-si-invisible_in_states-metadate-din-misiune_de_audit_si_control" author="CloudSoft.User1">
		<sql endDelimiter=";"><![CDATA[
			UPDATE METADATADEFINITION
			SET RESTRICTEDONEDITSTATES = 'misiune_finalizata',
				INVISIBLE_IN_STATES = 'asignare_task_user;completare_metadate;marcare_misiune_calendar_agenda'
			WHERE DOCUMENTTYPE_ID = (SELECT ID FROM DOCUMENTTYPE WHERE NAME = 'Misiune de audit si control')
				AND NAME IN ('recomandari_audit','recomandari_control','fisa_neconformitate','termen_remediere_fisa_neconformitate','fisa_neregularitate', 'termen_remediere_fisa_neregularitate');
		]]>
		</sql>
	</changeSet>
	
	<changeSet id="0043-update-mandatorystates-metadate-din-misiune_de_audit_si_control" author="CloudSoft.User1">
		<sql endDelimiter=";"><![CDATA[
			UPDATE METADATADEFINITION
			SET MANDATORYSTATES = 'adaugare_comentariu_atasamemt'
			WHERE DOCUMENTTYPE_ID = (SELECT ID FROM DOCUMENTTYPE WHERE NAME = 'Misiune de audit si control')
				AND NAME IN ('fisa_neconformitate','fisa_neregularitate');
		]]>
		</sql>
	</changeSet>	
	
	<changeSet id="0043-update-label-stare-pt-adaugare_comentariu_atasamemt-din-flux-misiune_de_audit_si_control" author="CloudSoft.User1">
		<sql endDelimiter=";"><![CDATA[
			UPDATE WORKFLOWSTATE
			SET NAME = 'Adaugare comentariu sau atasament, completare recomandari'
			WHERE TEMP_WORKFLOW_ID_ = (SELECT ID FROM WORKFLOW WHERE NAME = 'Misiune de audit si control')
			AND CODE = 'adaugare_comentariu_atasamemt';
		]]>
		</sql>
	</changeSet>
	
</databaseChangeLog>