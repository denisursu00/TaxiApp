<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
	xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd
        	http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

	<changeSet id="0034-stergere-validari-din-cerere_concediu" author="CloudSoft.User1">
		<sql endDelimiter=";"><![CDATA[
			DELETE FROM document_validation_definition
			WHERE DOCUMENT_TYPE_ID = (SELECT ID FROM documenttype WHERE NAME = 'Cerere concediu') 
   				AND CONDITION_EXPRESSION = '{data_initiere_cerere_concediu} < {data_inceput}'
				AND MESSAGE = 'Data initiere cerere concediu trebuie sa fie mai mica decat Data inceput concediu.';

			DELETE FROM document_validation_definition
			WHERE DOCUMENT_TYPE_ID = (SELECT ID FROM documenttype WHERE NAME = 'Cerere concediu') 
				AND CONDITION_EXPRESSION = '{data_initiere_cerere_concediu} < {data_sfarsit}' 
				AND MESSAGE = 'Data initiere cerere concediu trebuie sa fie mai mica decat Data sfarsit concediu.';
		]]>
		</sql>
	</changeSet>
	
	<changeSet id="0034-update-validare-data_redactare-mai-mare-egala-data-sedinta-la-minuta_sedinta_comisie_gl" author="CloudSoft.User1">
		<sql endDelimiter=";"><![CDATA[
			UPDATE document_validation_definition
			SET CONDITION_EXPRESSION = '{data_redactare} >= date:dateAsMetadataFormatFromMetadataDateTime({data_sedinta})'
			WHERE DOCUMENT_TYPE_ID = (SELECT ID FROM documenttype WHERE NAME ='Minuta sedinta Comisie GL') 
				AND CONDITION_EXPRESSION = '{data_redactare} >= {data_sedinta}' 
				AND MESSAGE = 'Data redactare trebuie sa fie mai mare sau egala cu Data sedinta.';
		]]>
		</sql>
	</changeSet>

</databaseChangeLog>