<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd
        	http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">
			
	<changeSet id="0006-creare-tabele" author="CloudSoft.User1">
		<sql endDelimiter=";">
			CREATE TABLE ALTE_DECONTURI (
				ID BIGINT NOT NULL,
				TITULAR_DECONT TEXT NOT NULL,
				NUMAR_DECONT TEXT NOT NULL,
				DATA_DECONT TIMESTAMP NOT NULL,
				AVANS_PRIMIT NUMERIC NOT NULL,
				TIP_AVANS_PRIMIT TEXT NOT NULL,
				TOTAL_CHELTUIELI NUMERIC,
				TOTAL_DE_INCASAT_RESTITUIT NUMERIC,
				ANULAT BOOLEAN,
				MOTIV_ANULARE TEXT,
				FINALIZAT BOOLEAN,
				
				CONSTRAINT ALTE_DECONTURI_PK PRIMARY KEY (ID)
			);
			
			CREATE TABLE ALTE_DECONTURI_CHELTUIALA (
				ID BIGINT NOT NULL,
				ALTE_DECONTURI_ID BIGINT NOT NULL,
				TIP_DOCUMENT_JUSTIFICATIV TEXT NOT NULL,
				EXPLICATIE TEXT,
				NUMAR_DOCUMENT_JUSTIFICATIV TEXT,
				DATA_DOCUMENT_JUSTIFICATIV TIMESTAMP,
				VALOARE_CHELTUIALA NUMERIC NOT NULL,
				
				CONSTRAINT ALTE_DECONTURI_CHELTUIALA_PK PRIMARY KEY (ID)
			);
		</sql>
	</changeSet>
	
	<changeSet id="0006-adaugare-constrangeri" author="CloudSoft.User1">
		<sql endDelimiter=";">
			ALTER TABLE ALTE_DECONTURI ADD CONSTRAINT ALTE_DECONTURI_NUMAR_DECONT_UQ UNIQUE (NUMAR_DECONT);
			
			ALTER TABLE ALTE_DECONTURI_CHELTUIALA ADD CONSTRAINT ALTE_DCNT_CHELT_ALT_DCNT_ID_FK FOREIGN KEY (ALTE_DECONTURI_ID) REFERENCES ALTE_DECONTURI (ID);
		</sql>
	</changeSet>
	
</databaseChangeLog>