<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd
        	http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

	<changeSet id="0012-adaugare-coloana-ajutatoare-pt-definire-flux-la-stare-in-cazul-migrarii" author="CloudSoft.User1">
		<sql endDelimiter=";"><![CDATA[
			ALTER TABLE workflowstate ADD COLUMN IF NOT EXISTS temp_workflow_id_ BIGINT;
		]]>
		</sql>
	</changeSet>
	
	<changeSet id="0012-flux-conciliere" author="CloudSoft.User1">
		<sql endDelimiter=";"><![CDATA[
			INSERT INTO workflow (id, description, name, processdefinitionid, version_number, base_version_id, source_version_id) VALUES (nextval('HIBERNATE_SEQUENCE'), null, 'Conciliere', null, 1, null, null);

			INSERT INTO workflow_doc_type (workflow_id, document_type_id) VALUES ((select id from workflow where name='Conciliere'), (select id from documenttype where name='Conciliere'));
			
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'adaugare_comentariu_atasament', 'Adaugare comentariu, atasament', 2, FALSE, null, (select id from workflow where name='Conciliere'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'asignare_task_user', 'Asignare user si initiere task', 1, FALSE, null, (select id from workflow where name='Conciliere'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'completare_finala_metadate', 'Completare finala a metadatelor', 2, FALSE, null, (select id from workflow where name='Conciliere'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'completare_initiala_metadate', 'Completare initiala a  metadatelor', 2, FALSE, null, (select id from workflow where name='Conciliere'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'conciliere_finalizata', 'Conciliere finalizata', 3, FALSE, null, (select id from workflow where name='Conciliere'));
			
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Metadate completate final', null, null, 'user_asignat', 'PARAMETER', (select id from workflowstate where code='adaugare_comentariu_atasament' and temp_workflow_id_=(select id from workflow where name='Conciliere')), (select id from workflowstate where code='completare_finala_metadate' and temp_workflow_id_=(select id from workflow where name='Conciliere')), (select id from workflow where name='Conciliere'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Task asignat si initiat', null, null, 'user_asignat', 'PARAMETER', (select id from workflowstate where code='completare_initiala_metadate' and temp_workflow_id_=(select id from workflow where name='Conciliere')), (select id from workflowstate where code='asignare_task_user' and temp_workflow_id_=(select id from workflow where name='Conciliere')), (select id from workflow where name='Conciliere'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Metadate completate initial', null, null, 'user_asignat', 'PARAMETER', (select id from workflowstate where code='completare_finala_metadate' and temp_workflow_id_=(select id from workflow where name='Conciliere')), (select id from workflowstate where code='completare_initiala_metadate' and temp_workflow_id_=(select id from workflow where name='Conciliere')), (select id from workflow where name='Conciliere'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Comentariu, atasament adaugat', null, null, null, null, (select id from workflowstate where code='conciliere_finalizata' and temp_workflow_id_=(select id from workflow where name='Conciliere')), (select id from workflowstate where code='adaugare_comentariu_atasament' and temp_workflow_id_=(select id from workflow where name='Conciliere')), (select id from workflow where name='Conciliere'));
		]]>
		</sql>
	</changeSet>
	
	<changeSet id="0012-flux-avans_salarial" author="CloudSoft.User1">
		<sql endDelimiter=";"><![CDATA[
			INSERT INTO workflow (id, description, name, processdefinitionid, version_number, base_version_id, source_version_id) VALUES (nextval('HIBERNATE_SEQUENCE'), null, 'Avans Salarial', null, 1, null, null);

			INSERT INTO workflow_doc_type (workflow_id, document_type_id) VALUES ((select id from workflow where name='Avans Salarial'), (select id from documenttype where name='Avans Salarial'));
			
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'adaugare_atasament_initiator_deic', 'Adaugare atasament - aprobat DEOP initiator DEIC', 2, FALSE, null, (select id from workflow where name='Avans Salarial'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'adaugare_atasament_initiator_deop', 'Adaugare atasament - aprobat DEIC initiator DEOP', 2, FALSE, null, (select id from workflow where name='Avans Salarial'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'adaugare_atasament_initiator_diferit_deop_deic', 'Adaugare atasament - aprobat DEOP initiator diferit de DEOP, DEIC', 2, FALSE, null, (select id from workflow where name='Avans Salarial'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'aprobare_deic', 'Aprobare DEIC', 2, FALSE, null, (select id from workflow where name='Avans Salarial'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'aprobare_deop_initiator_deic', 'Aprobare DEOP - initiator DEIC', 2, FALSE, null, (select id from workflow where name='Avans Salarial'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'aprobare_deop_initiator_diferit_deop_deic', 'Aprobare DEOP - initiator diferit de DEOP, DEIC', 2, FALSE, null, (select id from workflow where name='Avans Salarial'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'cerere_respinsa_deic', 'Cerere respinsa DEIC', 3, FALSE, null, (select id from workflow where name='Avans Salarial'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'cerere_respinsa_deop_initiator_deic', 'Cerere respinsa DEOP - initiator DEIC', 3, FALSE, null, (select id from workflow where name='Avans Salarial'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'cerere_respinsa_deop_initiator_diferit_deic', 'Cerere respinsa DEOP - initiator diferit DEIC', 3, FALSE, null, (select id from workflow where name='Avans Salarial'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'finalizare_cerere_initiator_deic', 'Aprobat DEOP initiator DEIC -  cerere aprobata', 3, FALSE, null, (select id from workflow where name='Avans Salarial'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'finalizare_cerere_initiator_deop', 'Aprobat DEIC initiator DEOP - cerere aprobata', 3, FALSE, null, (select id from workflow where name='Avans Salarial'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'finalizare_cerere_initiator_diferit_deop_deic', 'Aprobat DEOP initiator diferit de DEOP, DEIC - cerere aprobata', 3, FALSE, null, (select id from workflow where name='Avans Salarial'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'initiere_completare_metadate', 'Initiere cerere si completare metadate', 1, FALSE, null, (select id from workflow where name='Avans Salarial'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'stabilire_functie', 'Stabilire functie', 2, TRUE, null, (select id from workflow where name='Avans Salarial'));
			
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Atasament adaugat - initiator diferit DEOP, DEIC', null, null, null, null, (select id from workflowstate where code='finalizare_cerere_initiator_diferit_deop_deic' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflowstate where code='adaugare_atasament_initiator_diferit_deop_deic' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflow where name='Avans Salarial'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Cerere initiata si metadate completate', null, null, null, null, (select id from workflowstate where code='stabilire_functie' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflowstate where code='initiere_completare_metadate' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflow where name='Avans Salarial'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Atasament adaugat - initiator DEIC', null, null, null, null, (select id from workflowstate where code='finalizare_cerere_initiator_deic' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflowstate where code='adaugare_atasament_initiator_deic' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflow where name='Avans Salarial'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Aprobat DEOP - initiator diferit DEOP, DEIC', '{status_aprobare_deop} =~ ''.*#aprobat#.*''', null, 'initiator_cerere_avans', 'PARAMETER', (select id from workflowstate where code='adaugare_atasament_initiator_diferit_deop_deic' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflowstate where code='aprobare_deop_initiator_diferit_deop_deic' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflow where name='Avans Salarial'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Aprobat DEIC - Initiator DEOP', '({initiator_cerere_avans} == {utilizator_deop}) && ({status_aprobare_deic} =~ ''.*#aprobat#.*'')', null, 'initiator_cerere_avans', 'PARAMETER', (select id from workflowstate where code='adaugare_atasament_initiator_deop' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflowstate where code='aprobare_deic' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflow where name='Avans Salarial'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Atasament adaugat - initiator DEOP', null, null, null, null, (select id from workflowstate where code='finalizare_cerere_initiator_deop' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflowstate where code='adaugare_atasament_initiator_deop' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflow where name='Avans Salarial'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Initiator diferit de DEIC', '{initiator_cerere_avans} != {utilizator_deic}', null, 'utilizator_deic', 'PARAMETER', (select id from workflowstate where code='aprobare_deic' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflowstate where code='stabilire_functie' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflow where name='Avans Salarial'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Respins DEOP - initiator diferit DEIC', '{status_aprobare_deop} =~ ''.*#respins#.*''', null, null, null, (select id from workflowstate where code='cerere_respinsa_deop_initiator_diferit_deic' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflowstate where code='aprobare_deop_initiator_diferit_deop_deic' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflow where name='Avans Salarial'));
			WITH notificationRow AS (
				INSERT INTO transition_notifications (id, transition_id, email_subject_template, email_content_template) VALUES (nextval('HIBERNATE_SEQUENCE'), (select id from workflowtransition where name='Respins DEOP - initiator diferit DEIC' and workflow_id=(select id from workflow where name='Avans Salarial')), 'Cerere avans salariu', 'Sunteti informat ca cererea de avans salariu pentru {initiator_cerere_avans} a fost respinsa de {utilizator_deop}')
				RETURNING id
			) INSERT INTO user_meta_trans_notifs (notification_id, metadata_name) VALUES ((select id from notificationRow), 'utilizator_deic');
			WITH notificationRow AS (
				INSERT INTO transition_notifications (id, transition_id, email_subject_template, email_content_template) VALUES (nextval('HIBERNATE_SEQUENCE'), (select id from workflowtransition where name='Respins DEOP - initiator diferit DEIC' and workflow_id=(select id from workflow where name='Avans Salarial')), 'Cerere avans salariu', 'Sunteti informat ca cererea dvs de avans salariu a fost respinsa de {utilizator_deop}')
				RETURNING id
			) INSERT INTO user_meta_trans_notifs (notification_id, metadata_name) VALUES ((select id from notificationRow), 'initiator_cerere_avans');
			
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Aprobat DEOP - initiator DEIC', '{status_aprobare_deop} =~ ''.*#aprobat#.*''', null, 'initiator_cerere_avans', 'PARAMETER', (select id from workflowstate where code='adaugare_atasament_initiator_deic' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflowstate where code='aprobare_deop_initiator_deic' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflow where name='Avans Salarial'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Initiator DEIC', '{initiator_cerere_avans} == {utilizator_deic}', null, 'utilizator_deop', 'PARAMETER', (select id from workflowstate where code='aprobare_deop_initiator_deic' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflowstate where code='stabilire_functie' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflow where name='Avans Salarial'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Respins DEIC', '{status_aprobare_deic} =~ ''.*#respins#.*''', null, null, null, (select id from workflowstate where code='cerere_respinsa_deic' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflowstate where code='aprobare_deic' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflow where name='Avans Salarial'));
			WITH notificationRow AS (
				INSERT INTO transition_notifications (id, transition_id, email_subject_template, email_content_template) VALUES (nextval('HIBERNATE_SEQUENCE'), (select id from workflowtransition where name='Respins DEIC' and workflow_id=(select id from workflow where name='Avans Salarial')), 'Cerere avans salarial', 'Sunteti informat ca cererea dvs de avans salariu a fost respinsa de {utilizator_deic}')
				RETURNING id
			) INSERT INTO user_meta_trans_notifs (notification_id, metadata_name) VALUES ((select id from notificationRow), 'initiator_cerere_avans');
			
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Aprobat DEIC - initiator diferit de DEOP, DEIC', '({initiator_cerere_avans} != {utilizator_deop}) && ({status_aprobare_deic} =~ ''.*#aprobat#.*'')', null, 'utilizator_deop', 'PARAMETER', (select id from workflowstate where code='aprobare_deop_initiator_diferit_deop_deic' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflowstate where code='aprobare_deic' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflow where name='Avans Salarial'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Respins DEOP - initiator DEIC', '{status_aprobare_deop} =~ ''.*#respins#.*''', null, null, null, (select id from workflowstate where code='cerere_respinsa_deop_initiator_deic' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflowstate where code='aprobare_deop_initiator_deic' and temp_workflow_id_=(select id from workflow where name='Avans Salarial')), (select id from workflow where name='Avans Salarial'));
			WITH notificationRow AS (
				INSERT INTO transition_notifications (id, transition_id, email_subject_template, email_content_template) VALUES (nextval('HIBERNATE_SEQUENCE'), (select id from workflowtransition where name='Respins DEOP - initiator DEIC' and workflow_id=(select id from workflow where name='Avans Salarial')), 'Cerere avans salarial', 'Sunteti informat ca cererea dvs de avans salariu a fost respinsa de {utilizator_deop}')
				RETURNING id
			) INSERT INTO user_meta_trans_notifs (notification_id, metadata_name) VALUES ((select id from notificationRow), 'initiator_cerere_avans');
		]]>
		</sql>
	</changeSet>
	
	<changeSet id="0012-flux-initiere_dsp" author="CloudSoft.User1">
		<sql endDelimiter=";"><![CDATA[
			INSERT INTO workflow (id, description, name, processdefinitionid, version_number, base_version_id, source_version_id) VALUES (nextval('HIBERNATE_SEQUENCE'), null, 'Initiere DSP', null, 1, null, null);
			
			INSERT INTO workflow_doc_type (workflow_id, document_type_id) VALUES ((select id from workflow where name='Initiere DSP'), (select id from documenttype where name='Initiere DSP'));
			
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'adaugare_comentariu_atasament_responsabil_proiect', 'Adaugare comentariu, atasament responsabil proiect', 2, FALSE, null, (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'adaugare_comentariu_dsp_invalidat', 'Adaugare comentariu DSP invalidat', 2, FALSE, null, (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'adaugare_participanti_si_actiuni_viitoare', 'Adaugare participanti la proiect, respectiv actiuni viitoare', 2, FALSE, null, (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'asignare_task', 'Asignare task', 1, FALSE, null, (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'completare_metadate_dsp', 'Completare metadate DSP', 2, FALSE, null, (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'corectare_dsp', 'Corectare DSP', 2, FALSE, null, (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'corectare_participanti_desemnati', 'Corectare participanti desemnati', 2, FALSE, null, (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'dsp_finalizat', 'DSP finalizat', 3, FALSE, null, (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'dsp_invalidat', 'DSP invalidat', 3, FALSE, null, (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'marcare_eveniment_in_calendar', 'Marcare eveniment in calendar', 2, TRUE, 'ro.cloudSoft.cloudDoc.services.bpm.custom.dsp.DspInsertEventInCalendar', (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'marcare_proiect_activitati_in_proiecte', 'Marcare proiect, activitati in zona de proiecte, task-uri', 2, TRUE, 'ro.cloudSoft.cloudDoc.services.bpm.custom.DspInsertProjectAndTasks', (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'stabilire_functie_initiator_proiect', 'Stabilire functie initiator proiect', 2, TRUE, 'ro.cloudSoft.cloudDoc.services.bpm.custom.DspCompleteTaskByConditionInitiatorUserInGroup', (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'stabilire_functie_responsabil', 'Stabilire functie responsabil', 2, TRUE, 'ro.cloudSoft.cloudDoc.services.bpm.custom.DspCompleteTaskByConditionResponsibleUserInGroup', (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'stabilire_user_validator_date_dsp', 'Stabilire user validator date DSP', 2, FALSE, null, (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'stabilire_user_validator_participanti', 'Stabilire user validator participanti', 2, FALSE, null, (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'transmitere_emailuri_responsabili_comisii_gl', 'Transmitere emailuri Responsabili Comisii GL', 2, TRUE, 'ro.cloudSoft.cloudDoc.services.bpm.custom.DspSendMailToResponsabiliiDePeComisieGl', (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'validare_dsp', 'Validare DSP si desemnare responsabil', 2, FALSE, null, (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'validare_participanti_desemnati', 'Validare participanti desemnati', 2, FALSE, null, (select id from workflow where name='Initiere DSP'));
			
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Functie responsabil stabilita - verificare participanti director', null, null, 'responsabil', 'PARAMETER', (select id from workflowstate where code='stabilire_user_validator_participanti' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflowstate where code='stabilire_functie_responsabil' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Comentariu, atasament adaugat responsabil proiect', null, null, null, null, (select id from workflowstate where code='transmitere_emailuri_responsabili_comisii_gl' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflowstate where code='adaugare_comentariu_atasament_responsabil_proiect' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'User validator participanti stabilit', null, null, 'superior_validator_participanti', 'PARAMETER', (select id from workflowstate where code='validare_participanti_desemnati' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflowstate where code='stabilire_user_validator_participanti' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflow where name='Initiere DSP'));
			WITH notificationRow AS (
				INSERT INTO transition_notifications (id, transition_id, email_subject_template, email_content_template) VALUES (nextval('HIBERNATE_SEQUENCE'), (select id from workflowtransition where name='User validator participanti stabilit' and workflow_id=(select id from workflow where name='Initiere DSP')), 'Desemnare responsabil proiect', '{responsabil} a fost numit de către {superior_validator_date_dsp_preluat} ca Responsabil pentru proiectul {nume_proiect}')
				RETURNING id
			) INSERT INTO sup_of_user_mtadta_trans_notif (notification_id, metadata_name) VALUES ((select id from notificationRow), 'responsabil');
			
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Participantii desemnati nu necesita corectii', '{corectie_necesara} =~ ''.*#nu#.*''', null, null, null, (select id from workflowstate where code='marcare_proiect_activitati_in_proiecte' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflowstate where code='validare_participanti_desemnati' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Emailuri Responsabili Comisii GL transmise', null, null, null, null, (select id from workflowstate where code='dsp_finalizat' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflowstate where code='transmitere_emailuri_responsabili_comisii_gl' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Participanti desemnati corectati', null, null, 'superior_validator_participanti_preluat', 'PARAMETER', (select id from workflowstate where code='validare_participanti_desemnati' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflowstate where code='corectare_participanti_desemnati' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Eveniment marcat in calendar', null, null, 'responsabil', 'PARAMETER', (select id from workflowstate where code='adaugare_comentariu_atasament_responsabil_proiect' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflowstate where code='marcare_eveniment_in_calendar' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Task asignat', null, null, 'initiator_proiect', 'PARAMETER', (select id from workflowstate where code='completare_metadate_dsp' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflowstate where code='asignare_task' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'DSP corectat', null, null, 'superior_validator_date_dsp_preluat', 'PARAMETER', (select id from workflowstate where code='validare_dsp' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflowstate where code='corectare_dsp' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Participantii desemnati necesita corectii', '{corectie_necesara} =~ ''.*#da#.*''', null, 'responsabil', 'PARAMETER', (select id from workflowstate where code='corectare_participanti_desemnati' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflowstate where code='validare_participanti_desemnati' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Metadate DSP completate', null, null, null, null, (select id from workflowstate where code='stabilire_functie_initiator_proiect' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflowstate where code='completare_metadate_dsp' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Metadate completate validare date DSP superior', null, null, 'initiator_proiect', 'PARAMETER_HIERARCHICAL_SUP', (select id from workflowstate where code='validare_dsp' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflowstate where code='stabilire_functie_initiator_proiect' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Metadate completate validare date DSP director', null, null, 'initiator_proiect', 'PARAMETER', (select id from workflowstate where code='stabilire_user_validator_date_dsp' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflowstate where code='stabilire_functie_initiator_proiect' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'User validator date DSP stabilit', null, null, 'superior_validator_date_dsp', 'PARAMETER', (select id from workflowstate where code='validare_dsp' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflowstate where code='stabilire_user_validator_date_dsp' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'DSP invalid', '{status_validare_date_dsp} =~ ''.*#invalid#.*''', null, 'superior_validator_date_dsp_preluat', 'PARAMETER', (select id from workflowstate where code='adaugare_comentariu_dsp_invalidat' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflowstate where code='validare_dsp' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Comentariu DSP invalidat adaugat', null, null, null, null, (select id from workflowstate where code='dsp_invalidat' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflowstate where code='adaugare_comentariu_dsp_invalidat' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflow where name='Initiere DSP'));
			WITH notificationRow AS (
				INSERT INTO transition_notifications (id, transition_id, email_subject_template, email_content_template) VALUES (nextval('HIBERNATE_SEQUENCE'), (select id from workflowtransition where name='Comentariu DSP invalidat adaugat' and workflow_id=(select id from workflow where name='Initiere DSP')), 'Solicitare DSP invalidata', 'Solicitarea DSP, pentru proiectul {nume_proiect} a fost invalidata.')
				RETURNING id
			) INSERT INTO user_meta_trans_notifs (notification_id, metadata_name) VALUES ((select id from notificationRow), 'initiator_proiect');
			
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Functie responsabil stabilita - verificare participanti superior', null, null, 'responsabil', 'PARAMETER_HIERARCHICAL_SUP', (select id from workflowstate where code='validare_participanti_desemnati' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflowstate where code='stabilire_functie_responsabil' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflow where name='Initiere DSP'));
			WITH notificationRow AS (
				INSERT INTO transition_notifications (id, transition_id, email_subject_template, email_content_template) VALUES (nextval('HIBERNATE_SEQUENCE'), (select id from workflowtransition where name='Functie responsabil stabilita - verificare participanti superior' and workflow_id=(select id from workflow where name='Initiere DSP')), 'Desemnare responsabil proiect', '{responsabil} a fost numit de către {superior_validator_date_dsp_preluat} ca Responsabil pentru proiectul {nume_proiect}')
				RETURNING id
			) INSERT INTO sup_of_user_mtadta_trans_notif (notification_id, metadata_name) VALUES ((select id from notificationRow), 'responsabil');
			
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'DSP necesita corectii', '{status_validare_date_dsp} =~ ''.*#necesita_corectii#.*''', null, 'initiator_proiect', 'PARAMETER', (select id from workflowstate where code='corectare_dsp' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflowstate where code='validare_dsp' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Participanti la proiect adaugati, actiuni viitoare adaugate', null, null, null, null, (select id from workflowstate where code='stabilire_functie_responsabil' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflowstate where code='adaugare_participanti_si_actiuni_viitoare' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Proiect, activitati marcate in zona de proiecte, task-uri', null, null, null, null, (select id from workflowstate where code='marcare_eveniment_in_calendar' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflowstate where code='marcare_proiect_activitati_in_proiecte' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflow where name='Initiere DSP'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'DSP nu necesita corectii', '{status_validare_date_dsp} =~ ''.*#valid#.*''', null, 'responsabil', 'PARAMETER', (select id from workflowstate where code='adaugare_participanti_si_actiuni_viitoare' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflowstate where code='validare_dsp' and temp_workflow_id_=(select id from workflow where name='Initiere DSP')), (select id from workflow where name='Initiere DSP'));
			WITH notificationRow AS (
				INSERT INTO transition_notifications (id, transition_id, email_subject_template, email_content_template) VALUES (nextval('HIBERNATE_SEQUENCE'), (select id from workflowtransition where name='DSP nu necesita corectii' and workflow_id=(select id from workflow where name='Initiere DSP')), 'Responsabil proiect nr. {numar_proiect}', 'Sunteți informat că ați fost desemnat de {superior_validator_date_dsp_preluat}, ca responsabil pentru proiectul {nume_proiect}.')
				RETURNING id
			) INSERT INTO user_meta_trans_notifs (notification_id, metadata_name) VALUES ((select id from notificationRow), 'responsabil');
		]]>
		</sql>
	</changeSet>
	
	<changeSet id="0012-flux-investigatie" author="CloudSoft.User1">
		<sql endDelimiter=";"><![CDATA[
			INSERT INTO workflow (id, description, name, processdefinitionid, version_number, base_version_id, source_version_id) VALUES (nextval('HIBERNATE_SEQUENCE'), null, 'Investigatie', null, 1, null, null);

			INSERT INTO workflow_doc_type (workflow_id, document_type_id) VALUES ((select id from workflow where name='Investigatie'), (select id from documenttype where name='Investigatie'));
			
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'adaugare_comentariu_atasament', 'Adaugare comentariu, atasament', 2, FALSE, null, (select id from workflow where name='Investigatie'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'asignare_task_user', 'Asignare user si initiere task', 1, FALSE, null, (select id from workflow where name='Investigatie'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'completare_finala_metadate', 'Completare finala a metadatelor', 2, FALSE, null, (select id from workflow where name='Investigatie'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'completare_initiala_metadate', 'Completare initiala a metadatelor', 2, FALSE, null, (select id from workflow where name='Investigatie'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'investigatie_finalizata', 'Investigatie finalizata', 3, FALSE, null, (select id from workflow where name='Investigatie'));
			
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Metadate completate initial', null, null, 'user_asignat', 'PARAMETER', (select id from workflowstate where code='completare_finala_metadate' and temp_workflow_id_=(select id from workflow where name='Investigatie')), (select id from workflowstate where code='completare_initiala_metadate' and temp_workflow_id_=(select id from workflow where name='Investigatie')), (select id from workflow where name='Investigatie'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Comentariu, atasament adaugat', null, null, null, null, (select id from workflowstate where code='investigatie_finalizata' and temp_workflow_id_=(select id from workflow where name='Investigatie')), (select id from workflowstate where code='adaugare_comentariu_atasament' and temp_workflow_id_=(select id from workflow where name='Investigatie')), (select id from workflow where name='Investigatie'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Metadate completate final', null, null, 'user_asignat', 'PARAMETER', (select id from workflowstate where code='adaugare_comentariu_atasament' and temp_workflow_id_=(select id from workflow where name='Investigatie')), (select id from workflowstate where code='completare_finala_metadate' and temp_workflow_id_=(select id from workflow where name='Investigatie')), (select id from workflow where name='Investigatie'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Task asignat si initiat', null, null, 'user_asignat', 'PARAMETER', (select id from workflowstate where code='completare_initiala_metadate' and temp_workflow_id_=(select id from workflow where name='Investigatie')), (select id from workflowstate where code='asignare_task_user' and temp_workflow_id_=(select id from workflow where name='Investigatie')), (select id from workflow where name='Investigatie'));
		]]>
		</sql>
	</changeSet>
	
	<changeSet id="0012-flux-misiune_de_audit_si_control" author="CloudSoft.User1">
		<sql endDelimiter=";"><![CDATA[
			INSERT INTO workflow (id, description, name, processdefinitionid, version_number, base_version_id, source_version_id) VALUES (nextval('HIBERNATE_SEQUENCE'), null, 'Misiune de audit si control', null, 1, null, null);
	
			INSERT INTO workflow_doc_type (workflow_id, document_type_id) VALUES ((select id from workflow where name='Misiune de audit si control'), (select id from documenttype where name='Misiune de audit si control'));
			
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'adaugare_comentariu_atasamemt', 'Adaugare comentariu sau atasament', 2, FALSE, null, (select id from workflow where name='Misiune de audit si control'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'asignare_task_user', 'Asignare user si initiere task', 1, FALSE, null, (select id from workflow where name='Misiune de audit si control'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'completare_metadate', 'Completare metadate Misiune audit', 2, FALSE, null, (select id from workflow where name='Misiune de audit si control'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'marcare_misiune_calendar_agenda', 'Marcare misiune in Calendar ARB si in Agenda PE', 2, TRUE, 'ro.cloudSoft.cloudDoc.services.bpm.custom.MisiuneAuditSiControlInsertAuditCalendarEvent', (select id from workflow where name='Misiune de audit si control'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'misiune_finalizata', 'Misiune finalizata', 3, FALSE, null, (select id from workflow where name='Misiune de audit si control'));
			
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Task asignat si initiat', null, null, 'initiator_misiune', 'PARAMETER', (select id from workflowstate where code='completare_metadate' and temp_workflow_id_=(select id from workflow where name='Misiune de audit si control')), (select id from workflowstate where code='asignare_task_user' and temp_workflow_id_=(select id from workflow where name='Misiune de audit si control')), (select id from workflow where name='Misiune de audit si control'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Metadate completate', null, null, null, null, (select id from workflowstate where code='marcare_misiune_calendar_agenda' and temp_workflow_id_=(select id from workflow where name='Misiune de audit si control')), (select id from workflowstate where code='completare_metadate' and temp_workflow_id_=(select id from workflow where name='Misiune de audit si control')), (select id from workflow where name='Misiune de audit si control'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Misiune marcata in Calendar ARB si in Agenda PE', null, null, 'initiator_misiune', 'PARAMETER', (select id from workflowstate where code='adaugare_comentariu_atasamemt' and temp_workflow_id_=(select id from workflow where name='Misiune de audit si control')), (select id from workflowstate where code='marcare_misiune_calendar_agenda' and temp_workflow_id_=(select id from workflow where name='Misiune de audit si control')), (select id from workflow where name='Misiune de audit si control'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Comentariu sau atasament adaugat', null, null, null, null, (select id from workflowstate where code='misiune_finalizata' and temp_workflow_id_=(select id from workflow where name='Misiune de audit si control')), (select id from workflowstate where code='adaugare_comentariu_atasamemt' and temp_workflow_id_=(select id from workflow where name='Misiune de audit si control')), (select id from workflow where name='Misiune de audit si control'));	
		]]>
		</sql>
	</changeSet>
	
	<changeSet id="0012-flux-modificare_schema" author="CloudSoft.User1">
		<sql endDelimiter=";"><![CDATA[
			INSERT INTO workflow (id, description, name, processdefinitionid, version_number, base_version_id, source_version_id) VALUES (nextval('HIBERNATE_SEQUENCE'), null, 'Modificare schema', null, 1, null, null);

			INSERT INTO workflow_doc_type (workflow_id, document_type_id) VALUES ((select id from workflow where name='Modificare schema'), (select id from documenttype where name='Modificare schema'));
			
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'adaugare_comentariu_atasament', 'Adaugare comentariu, atasament', 2, FALSE, null, (select id from workflow where name='Modificare schema'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'asignare_task_user', 'Asignare user si initiere task', 1, FALSE, null, (select id from workflow where name='Modificare schema'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'completare_metadate_modificare_schema', 'Completare metadate modificare schema', 2, FALSE, null, (select id from workflow where name='Modificare schema'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'modificare_schema_finalizata', 'Modificare schema finalizata', 3, FALSE, null, (select id from workflow where name='Modificare schema'));
			
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Comentariu, atasament adaugat', null, null, null, null, (select id from workflowstate where code='modificare_schema_finalizata' and temp_workflow_id_=(select id from workflow where name='Modificare schema')), (select id from workflowstate where code='adaugare_comentariu_atasament' and temp_workflow_id_=(select id from workflow where name='Modificare schema')), (select id from workflow where name='Modificare schema'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Metadate modificare schema completate', null, null, 'initiator_modificare_schema', 'PARAMETER', (select id from workflowstate where code='adaugare_comentariu_atasament' and temp_workflow_id_=(select id from workflow where name='Modificare schema')), (select id from workflowstate where code='completare_metadate_modificare_schema' and temp_workflow_id_=(select id from workflow where name='Modificare schema')), (select id from workflow where name='Modificare schema'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Task asignat si initiat', null, null, 'initiator_modificare_schema', 'PARAMETER', (select id from workflowstate where code='completare_metadate_modificare_schema' and temp_workflow_id_=(select id from workflow where name='Modificare schema')), (select id from workflowstate where code='asignare_task_user' and temp_workflow_id_=(select id from workflow where name='Modificare schema')), (select id from workflow where name='Modificare schema'));		
		]]>
		</sql>
	</changeSet>
	
	<changeSet id="0012-flux-nota_cd_consilieri_financiari_bancari_das" author="CloudSoft.User1">
		<sql endDelimiter=";"><![CDATA[
			INSERT INTO workflow (id, description, name, processdefinitionid, version_number, base_version_id, source_version_id) VALUES (nextval('HIBERNATE_SEQUENCE'), null, 'Nota CD - Consilieri Financiari Bancari DAS', null, 1, null, null);

			INSERT INTO workflow_doc_type (workflow_id, document_type_id) VALUES ((select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS'), (select id from documenttype where name='Nota CD - Consilieri Financiari Bancari DAS'));
			
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'adaugare_atasament', 'Adaugare nota CD ca atasament', 2, FALSE, null, (select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'asignare_task_user', 'Asignare user si initiere task', 1, FALSE, null, (select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'completare_metadate', 'Completare metadate Nota CD', 2, FALSE, null, (select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'corectie_nota_cd', 'Corectie Nota CD', 2, FALSE, null, (select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'finalizare_nota_cd', 'Finalizare Nota CD', 3, FALSE, null, (select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'verificare_nota_cd', 'Verificare Nota CD', 2, FALSE, null, (select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS'));
			
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Task asignat si initiat', null, null, 'initiator_nota_cd', 'PARAMETER', (select id from workflowstate where code='completare_metadate' and temp_workflow_id_=(select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS')), (select id from workflowstate where code='asignare_task_user' and temp_workflow_id_=(select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS')), (select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Nota CD corectata', null, null, 'user_deop', 'PARAMETER', (select id from workflowstate where code='verificare_nota_cd' and temp_workflow_id_=(select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS')), (select id from workflowstate where code='corectie_nota_cd' and temp_workflow_id_=(select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS')), (select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Nota CD verificata - nu necesita corectii', '{corectie_necesara} =~ ''.*#nu#.*''', null, 'initiator_nota_cd', 'PARAMETER', (select id from workflowstate where code='adaugare_atasament' and temp_workflow_id_=(select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS')), (select id from workflowstate where code='verificare_nota_cd' and temp_workflow_id_=(select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS')), (select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Metadate completate', null, null, 'user_deop', 'PARAMETER', (select id from workflowstate where code='verificare_nota_cd' and temp_workflow_id_=(select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS')), (select id from workflowstate where code='completare_metadate' and temp_workflow_id_=(select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS')), (select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Nota CD verificata - corectie necesara', '{corectie_necesara} =~ ''.*#da#.*''', null, 'initiator_nota_cd', 'PARAMETER', (select id from workflowstate where code='corectie_nota_cd' and temp_workflow_id_=(select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS')), (select id from workflowstate where code='verificare_nota_cd' and temp_workflow_id_=(select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS')), (select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Nota CD atasata', null, null, null, null, (select id from workflowstate where code='finalizare_nota_cd' and temp_workflow_id_=(select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS')), (select id from workflowstate where code='adaugare_atasament' and temp_workflow_id_=(select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS')), (select id from workflow where name='Nota CD - Consilieri Financiari Bancari DAS'));
		]]>
		</sql>
	</changeSet>
	
	<changeSet id="0012-flux-nota_cd_useri_arb" author="CloudSoft.User1">
		<sql endDelimiter=";"><![CDATA[
			INSERT INTO workflow (id, description, name, processdefinitionid, version_number, base_version_id, source_version_id) VALUES (nextval('HIBERNATE_SEQUENCE'), null, 'Nota CD - Useri ARB', null, 1, null, null);
			
			INSERT INTO workflow_doc_type (workflow_id, document_type_id) VALUES ((select id from workflow where name='Nota CD - Useri ARB'), (select id from documenttype where name='Nota CD - Useri ARB'));
			
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'adaugare_atasament', 'Adaugare nota CD ca atasament', 2, FALSE, null, (select id from workflow where name='Nota CD - Useri ARB'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'asignare_task_user', 'Asignare user si initiere task', 1, FALSE, null, (select id from workflow where name='Nota CD - Useri ARB'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'completare_metadate', 'Completare metadate Nota CD', 2, FALSE, null, (select id from workflow where name='Nota CD - Useri ARB'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'corectie_nota_cd', 'Corectie Nota CD', 2, FALSE, null, (select id from workflow where name='Nota CD - Useri ARB'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'finalizare_nota_cd', 'Finalizare Nota CD', 3, FALSE, null, (select id from workflow where name='Nota CD - Useri ARB'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'stabilire_functie_initiator', 'Stabilire functie initiator', 2, TRUE, 'ro.cloudSoft.cloudDoc.services.bpm.custom.NotaCdCompleteTaskByConditionUserInGroup', (select id from workflow where name='Nota CD - Useri ARB'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 0, 'stabilire_user_validator', 'Stabilire user validator', 2, FALSE, null, (select id from workflow where name='Nota CD - Useri ARB'));
			INSERT INTO workflowstate (id, attachmentspermission, code, name, statetype, automaticrunning, classpath, temp_workflow_id_) VALUES (nextval('HIBERNATE_SEQUENCE'), 3, 'verificare_nota_cd', 'Verificare Nota CD', 2, FALSE, null, (select id from workflow where name='Nota CD - Useri ARB'));
			
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Nota CD corectata', null, null, 'user_validator_preluat', 'PARAMETER', (select id from workflowstate where code='verificare_nota_cd' and temp_workflow_id_=(select id from workflow where name='Nota CD - Useri ARB')), (select id from workflowstate where code='corectie_nota_cd' and temp_workflow_id_=(select id from workflow where name='Nota CD - Useri ARB')), (select id from workflow where name='Nota CD - Useri ARB'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'User validator stabilit', null, null, 'user_validator', 'PARAMETER', (select id from workflowstate where code='verificare_nota_cd' and temp_workflow_id_=(select id from workflow where name='Nota CD - Useri ARB')), (select id from workflowstate where code='stabilire_user_validator' and temp_workflow_id_=(select id from workflow where name='Nota CD - Useri ARB')), (select id from workflow where name='Nota CD - Useri ARB'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Metadate completate - verificare superior', null, null, 'initiator_nota_cd', 'PARAMETER_HIERARCHICAL_SUP', (select id from workflowstate where code='verificare_nota_cd' and temp_workflow_id_=(select id from workflow where name='Nota CD - Useri ARB')), (select id from workflowstate where code='stabilire_functie_initiator' and temp_workflow_id_=(select id from workflow where name='Nota CD - Useri ARB')), (select id from workflow where name='Nota CD - Useri ARB'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Nota CD verificata - corectie necesara', '{corectie_necesara} =~ ''.*#da#.*''', null, 'initiator_nota_cd', 'PARAMETER', (select id from workflowstate where code='corectie_nota_cd' and temp_workflow_id_=(select id from workflow where name='Nota CD - Useri ARB')), (select id from workflowstate where code='verificare_nota_cd' and temp_workflow_id_=(select id from workflow where name='Nota CD - Useri ARB')), (select id from workflow where name='Nota CD - Useri ARB'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Task asignat si initiat', null, null, 'initiator_nota_cd', 'PARAMETER', (select id from workflowstate where code='completare_metadate' and temp_workflow_id_=(select id from workflow where name='Nota CD - Useri ARB')), (select id from workflowstate where code='asignare_task_user' and temp_workflow_id_=(select id from workflow where name='Nota CD - Useri ARB')), (select id from workflow where name='Nota CD - Useri ARB'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Metadate completate', null, null, null, null, (select id from workflowstate where code='stabilire_functie_initiator' and temp_workflow_id_=(select id from workflow where name='Nota CD - Useri ARB')), (select id from workflowstate where code='completare_metadate' and temp_workflow_id_=(select id from workflow where name='Nota CD - Useri ARB')), (select id from workflow where name='Nota CD - Useri ARB'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Nota CD atasata', null, null, null, null, (select id from workflowstate where code='finalizare_nota_cd' and temp_workflow_id_=(select id from workflow where name='Nota CD - Useri ARB')), (select id from workflowstate where code='adaugare_atasament' and temp_workflow_id_=(select id from workflow where name='Nota CD - Useri ARB')), (select id from workflow where name='Nota CD - Useri ARB'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Nota CD verificata - nu necesita corectii', '{corectie_necesara} =~ ''.*#nu#.*''', null, 'initiator_nota_cd', 'PARAMETER', (select id from workflowstate where code='adaugare_atasament' and temp_workflow_id_=(select id from workflow where name='Nota CD - Useri ARB')), (select id from workflowstate where code='verificare_nota_cd' and temp_workflow_id_=(select id from workflow where name='Nota CD - Useri ARB')), (select id from workflow where name='Nota CD - Useri ARB'));
			INSERT INTO workflowtransition (id, available_4_auto_actions_only, deadlineaction, deadlineactiontype, deadlinenotifyresendinterval, deadlineperiod, name, routingcondition, routingdestinationid, routingdestinationparameter, routingtype, finalstate_id, startstate_id, workflow_id) VALUES (nextval('HIBERNATE_SEQUENCE'), FALSE, FALSE, null, null, null, 'Metadate completate - verificare director', null, null, 'initiator_nota_cd', 'PARAMETER', (select id from workflowstate where code='stabilire_user_validator' and temp_workflow_id_=(select id from workflow where name='Nota CD - Useri ARB')), (select id from workflowstate where code='stabilire_functie_initiator' and temp_workflow_id_=(select id from workflow where name='Nota CD - Useri ARB')), (select id from workflow where name='Nota CD - Useri ARB'));
		]]>
		</sql>
	</changeSet>
	
</databaseChangeLog>