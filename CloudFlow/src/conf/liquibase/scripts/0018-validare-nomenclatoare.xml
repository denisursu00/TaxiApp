<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd
        	http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

	<changeSet id="0018-creare-tabel-nomenclator_validation" author="CloudSoft.User1">
		<sql endDelimiter=";">
			CREATE TABLE NOMENCLATOR_VALIDATION (
				ID BIGINT NOT NULL,
				NAME TEXT NOT NULL,
				NOMENCLATOR_ID BIGINT NOT NULL,
				CONDITION_EXPRESSION TEXT NOT NULL,
				MESSAGE TEXT NOT NULL,
				VALIDATION_ORDER INTEGER NOT NULL,
				
				CONSTRAINT NOMENCLATOR_VALIDATION_PK PRIMARY KEY (ID)
			);
		</sql>
	</changeSet>
	
	<changeSet id="0018-adaugare-constrangeri-pt-tabel-nomenclator_validation" author="CloudSoft.User1">
		<sql endDelimiter=";">			
			ALTER TABLE NOMENCLATOR_VALIDATION ADD CONSTRAINT NOM_VALDTN_NAME_AND_NOM_ID_UQ UNIQUE (NAME, NOMENCLATOR_ID);
			ALTER TABLE NOMENCLATOR_VALIDATION ADD CONSTRAINT NOM_VALDTN_NOMENCLATOR_ID_FK FOREIGN KEY ( NOMENCLATOR_ID ) REFERENCES NOMENCLATOR ( ID );	
		</sql>
	</changeSet>
	
</databaseChangeLog>